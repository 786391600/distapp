(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["taskList"],{"07e8":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cube-page",class:t.type},[a("header",{staticClass:"header"},[a("h1",[t._v(t._s(t.title))]),a("i",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:t.back}}),a("div",{staticClass:"header-edit"},[t._t("edit")],2)]),a("div",{class:{wrapper:!0,isWhite:"white"===t.type}},[a("section",{directives:[{name:"show",rawName:"v-show",value:t.desc,expression:"desc"}],staticClass:"desc"},[t._t("desc",[t._v(t._s(t.desc))])],2),a("main",{staticClass:"content"},[t._t("content",[t._v(t._s(t.content))])],2)])])},s=[],n=a("d225"),c=a("b0b4"),o=a("308d"),r=a("6bb5"),l=a("4e2b"),u=a("9ab4"),v=a("60a3"),d=function(t){function e(){return Object(n["a"])(this,e),Object(o["a"])(this,Object(r["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"back",value:function(){this.$router.back()}}]),e}(v["c"]);Object(u["a"])([Object(v["b"])()],d.prototype,"msg",void 0),Object(u["a"])([Object(v["b"])({default:"",required:!0})],d.prototype,"title",void 0),Object(u["a"])([Object(v["b"])({default:""})],d.prototype,"type",void 0),Object(u["a"])([Object(v["b"])({default:""})],d.prototype,"desc",void 0),Object(u["a"])([Object(v["b"])({default:""})],d.prototype,"content",void 0),Object(u["a"])([Object(v["b"])({default:!0})],d.prototype,"isBack",void 0),d=Object(u["a"])([v["a"]],d);var b=d,h=b,f=(a("ca73"),a("2877")),p=Object(f["a"])(h,i,s,!1,null,"0717ebb4",null);e["a"]=p.exports},"0c27":function(t,e,a){},"10f0":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav-box"},[a("div",{staticClass:"nav-scroll"},[a("div",{staticClass:"item-box"},t._l(t.list,function(e,i){return a("div",{key:i,class:{box:!0,active:t.currentValue===e.value},on:{click:function(a){return t.setValue(e.value)}}},[t._v(t._s(e.label))])}),0)])])},s=[],n=a("d225"),c=a("b0b4"),o=a("308d"),r=a("6bb5"),l=a("4e2b"),u=a("9ab4"),v=a("60a3"),d=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(o["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.currentValue="",t}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"created",value:function(){console.log("navvvvvvvvvvvvvvvvvvvvvvvvvvvvv"),this.currentValue=this.list[0].value,this.emitValue(this.list[0].value)}},{key:"setValue",value:function(t){this.currentValue=t,this.emitValue(t)}},{key:"emitValue",value:function(t){this.$emit("change",t)}}]),e}(v["c"]);Object(u["a"])([Object(v["b"])()],d.prototype,"list",void 0),d=Object(u["a"])([Object(v["a"])({components:{}})],d);var b=d,h=b,f=(a("1266"),a("2877")),p=Object(f["a"])(h,i,s,!1,null,null,null);e["a"]=p.exports},1266:function(t,e,a){"use strict";var i=a("0c27"),s=a.n(i);s.a},"1c74":function(t,e,a){},"2b1f":function(t,e,a){},"3a45":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"page-move"}},[a("router-view",{staticClass:"cube-view"})],1)},s=[],n={},c=n,o=(a("72ee"),a("2877")),r=Object(o["a"])(c,i,s,!1,null,null,null);e["a"]=r.exports},"72ee":function(t,e,a){"use strict";var i=a("2b1f"),s=a.n(i);s.a},a181:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{attrs:{type:"form-def",title:t.title,isBack:!0}},[a("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"list"},[t._l(t.dataList,function(e,i){return a("div",{key:i,staticClass:"list-item"},[a("div",{staticClass:"list-item-title"},[a("span",[t._v(t._s(i+1)+"."+t._s(e.name))]),a("div",{staticClass:"btn",on:{click:function(e){return t.deletePoint(i)}}},[t._v("\r\n                 删除\r\n              ")])]),t._l(e.timeValue,function(e,s){return a("div",{key:s+"-"+i,staticClass:"list-item-content"},[t._v("\r\n             发车时间： "+t._s(e)+"\r\n            ")])}),a("div",{staticClass:"list-item-content"},[a("span",[t._v(t._s(e.state?"进行中":"已关闭"))]),a("span",[a("cube-switch",{model:{value:e.state,callback:function(a){t.$set(e,"state",a)},expression:"item.state"}})],1)]),a("div",{staticClass:"oprate"},[a("div",{staticClass:"btn",on:{click:function(a){return t.showInfo(e)}}},[t._v("\r\n                 订票详情\r\n              ")])])],2)}),a("div",{staticClass:"oprate top-line"},[t.showTimes?a("div",{staticClass:"btn",on:{click:t.addTask}},[t._v("\r\n              添加任务\r\n            ")]):t._e(),a("div",{staticClass:"btn success",on:{click:t.saveTask}},[t._v("\r\n                 保存\r\n            ")])])],2),a("pageView")],1)])},s=[],n=(a("456d"),a("ac6a"),a("d225")),c=a("b0b4"),o=a("308d"),r=a("6bb5"),l=a("4e2b"),u=a("9ab4"),v=a("60a3"),d=a("07e8"),b=a("3a45"),h=a("10f0"),f=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(o["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.point={},t.showMore=!0,t.currentTab="",t.dataList=[],t.timeRows=[],t.dialog=null,t}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"created",value:function(){this.fleetId=this.$route.query.fleetId,this.title="报名任务",this.getFleetInfoById(this.fleetId)}},{key:"getFleetInfoById",value:function(t){var e=this,a=this["$createToast"]({time:0,txt:"加载..."});a.show(),this.$store.dispatch("getFleetInfoById",{id:t}).then(function(t){if(t.success){var i=t.data,s=i.fleetTask||[];e.dataList=s,e.$set(e,"timeRows",i.timeRows)}a.hide()})}},{key:"getTime",value:function(t){if(!this.showTimes)return"";var e="start"===this.currentTab?t:this.pointObj.start.length+t;if(!this.timeRows[e])return"";var a=this.timeRows[e][e+1];return a?"去下个点位  预估路程："+Math.floor(a.distance/1e3)+"公里  预估时间："+this.secondsToTime(a.duration):"此点为终点站~"}},{key:"addTask",value:function(){this.$router.push({name:"fleetTaskUpdate",query:{type:"add",data:{}}})}},{key:"secondsToTime",value:function(t){var e,a,i;e=Math.floor(t/3600),i=t%3600,a=Math.floor(i/60),i%=60;var s="";return e&&(s=s+e+"小时"),a&&(s=s+a+"分钟"),i&&(s=s+i+"秒"),s}},{key:"saveTask",value:function(){var t=this,e=this["$createToast"]({time:0,txt:"保存中..."});e.show(),this.$store.dispatch("updateFleetInfoById",{id:this.fleetId,key:"fleetTask",data:this.dataList}).then(function(a){a.success&&(console.log(a,"oooooooooo"),t.$createDialog({type:"alert",title:"提示",content:"保存成功！",icon:"cubeic-alert"}).show()),e.hide()})}},{key:"validate",value:function(){var t=this,e=!0,a="";return Object.keys(this.pointObj).forEach(function(i){0===t.pointObj[i].length?(e=!1,a="start"===i?"出发点位必填":"到达点位必填"):t.pointObj[i].forEach(function(t){t.point&&t.point.location||(e=!1,a=t.label+"未添加定位！")})}),e||this.$createDialog({type:"alert",title:"提示",content:a,icon:"cubeic-alert"}).show(),e}},{key:"addOrUpdatePoint",value:function(t){var e=this.pointObj[this.currentTab][t],a=e.point?"update":"add",i=this.currentTab;this.$router.push({name:"mapSelect",query:{backInfo:{updateIndex:t,updateType:i},location:"update"===a?e.point.location:[]}})}},{key:"deletePoint",value:function(t){var e=this,a="任务删除将不会恢复，请确认是否删除！",i=this.$createDialog({type:"confirm",title:"删除确认",content:a,confirmBtn:{text:"确认删除",active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:"取消",active:!1,disabled:!1,href:"javascript:;"},onConfirm:function(){e.dataList.splice(t,1)},onCancel:function(){}});i.show()}},{key:"updateDialotText",value:function(t,e){this.pointTextDialot(t,"update",e)}},{key:"pointTextDialot",value:function(t,e,a){this.$router.push({})}},{key:"navChange",value:function(t){console.log(t),this.currentTab=t}},{key:"showInfo",value:function(t){var e=[];"time"===t.taskType&&(e=t.timeValue.map(function(t){return new Date(t).getTime()})),this.$router.push({name:"fleetTaskInfo",query:{fleetId:this.fleetId,departureTimeList:e}})}},{key:"routeChange",value:function(t){var e=this.$store.state.backData;if("fleetTask"===e.route){var a=e.data;"add"===a.type&&(console.log(a.data),this.dataList.push(a.data)),this.$store.commit("SET_BACK_DATA",{})}}},{key:"showTimes",get:function(){return this.timeRows&&this.timeRows.length>0}}]),e}(v["c"]);Object(u["a"])([Object(v["b"])({default:"default value"})],f.prototype,"propB",void 0),Object(u["a"])([Object(v["d"])("$route")],f.prototype,"routeChange",null),f=Object(u["a"])([Object(v["a"])({components:{Page:d["a"],pageView:b["a"],navView:h["a"]}})],f);var p=f,m=p,y=(a("a6b0"),a("2877")),k=Object(y["a"])(m,i,s,!1,null,null,null);e["default"]=k.exports},a6b0:function(t,e,a){"use strict";var i=a("1c74"),s=a.n(i);s.a},b13e:function(t,e,a){},ca73:function(t,e,a){"use strict";var i=a("b13e"),s=a.n(i);s.a}}]);
//# sourceMappingURL=taskList.7539caec.js.map