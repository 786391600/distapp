(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fleetOrderList"],{"07e8":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cube-page",class:t.type},[a("header",{staticClass:"header"},[a("h1",[t._v(t._s(t.title))]),a("i",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:t.back}}),a("div",{staticClass:"header-edit"},[t._t("edit")],2)]),a("div",{class:{wrapper:!0,isWhite:"white"===t.type}},[a("section",{directives:[{name:"show",rawName:"v-show",value:t.desc,expression:"desc"}],staticClass:"desc"},[t._t("desc",[t._v(t._s(t.desc))])],2),a("main",{staticClass:"content"},[t._t("content",[t._v(t._s(t.content))])],2)])])},i=[],r=a("d225"),n=a("b0b4"),c=a("308d"),o=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),h=function(t){function e(){return Object(r["a"])(this,e),Object(c["a"])(this,Object(o["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(n["a"])(e,[{key:"back",value:function(){this.$router.back()}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])()],h.prototype,"msg",void 0),Object(u["a"])([Object(d["b"])({default:"",required:!0})],h.prototype,"title",void 0),Object(u["a"])([Object(d["b"])({default:""})],h.prototype,"type",void 0),Object(u["a"])([Object(d["b"])({default:""})],h.prototype,"desc",void 0),Object(u["a"])([Object(d["b"])({default:""})],h.prototype,"content",void 0),Object(u["a"])([Object(d["b"])({default:!0})],h.prototype,"isBack",void 0),h=Object(u["a"])([d["a"]],h);var v=h,p=v,f=(a("ca73"),a("2877")),b=Object(f["a"])(p,s,i,!1,null,"0717ebb4",null);e["a"]=b.exports},"0c27":function(t,e,a){},"10f0":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav-box"},[a("div",{staticClass:"nav-scroll"},[a("div",{staticClass:"item-box"},t._l(t.list,function(e,s){return a("div",{key:s,class:{box:!0,active:t.currentValue===e.value},on:{click:function(a){return t.setValue(e.value)}}},[t._v(t._s(e.label))])}),0)])])},i=[],r=a("d225"),n=a("b0b4"),c=a("308d"),o=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),h=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(o["a"])(e).apply(this,arguments)),t.currentValue="",t}return Object(l["a"])(e,t),Object(n["a"])(e,[{key:"created",value:function(){console.log("navvvvvvvvvvvvvvvvvvvvvvvvvvvvv"),this.currentValue=this.list[0].value,this.emitValue(this.list[0].value)}},{key:"setValue",value:function(t){this.currentValue=t,this.emitValue(t)}},{key:"emitValue",value:function(t){this.$emit("change",t)}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])()],h.prototype,"list",void 0),h=Object(u["a"])([Object(d["a"])({components:{}})],h);var v=h,p=v,f=(a("1266"),a("2877")),b=Object(f["a"])(p,s,i,!1,null,null,null);e["a"]=b.exports},1266:function(t,e,a){"use strict";var s=a("0c27"),i=a.n(s);i.a},"170f":function(t,e,a){"use strict";var s=a("1f3f"),i=a.n(s);i.a},"1bc9":function(t,e,a){"use strict";var s=a("53e4"),i=a.n(s);i.a},"1f3f":function(t,e,a){},"2b1f":function(t,e,a){},"3a45":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"page-move"}},[a("router-view",{staticClass:"cube-view"})],1)},i=[],r={},n=r,c=(a("72ee"),a("2877")),o=Object(c["a"])(n,s,i,!1,null,null,null);e["a"]=o.exports},"3c22":function(t,e,a){"use strict";var s=a("57fe"),i=a.n(s);i.a},"53e4":function(t,e,a){},"57fe":function(t,e,a){},6156:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{attrs:{type:"form-def",title:t.title,isBack:!0}},[a("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"list"},[t._l(t.dataList,function(e,s){return a("div",{key:s,staticClass:"list-item"},[a("div",{staticClass:"list-item-title"},[t._v("车牌号: "+t._s(e.licensePlate))]),a("div",{staticClass:"list-item-content"},[a("p",[t._v("座位数: "+t._s(e.number||0)+"座")])]),a("div",{staticClass:"oprate"},[a("div",{staticClass:"btn",on:{click:function(a){return t.updateCar(e,s)}}},[t._v("\r\n                 修改\r\n              ")]),a("div",{staticClass:"btn",on:{click:function(e){return t.deleteCar(s)}}},[t._v("\r\n                 删除\r\n              ")])])])}),a("div",{staticClass:"oprate top-line"},[a("div",{staticClass:"btn",on:{click:t.addCar}},[t._v("\r\n              添加车牌\r\n            ")]),a("div",{staticClass:"btn success",on:{click:t.saveTask}},[t._v("\r\n              保存并分配\r\n            ")])])],2),a("pageView")],1)])},i=[],r=(a("456d"),a("ac6a"),a("d225")),n=a("b0b4"),c=a("308d"),o=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),h=a("07e8"),v=a("3a45"),p=a("10f0"),f=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(o["a"])(e).apply(this,arguments)),t.point={},t.showMore=!0,t.currentTab="",t.dataList=[],t.departureTime="",t.timeRows=[],t.dialog=null,t}return Object(l["a"])(e,t),Object(n["a"])(e,[{key:"created",value:function(){this.title="车牌管理";var t=this.$route.query;this.fleetId=t.fleetId,this.departureTime=t.departureTime,this.dataList=t.carList?t.carList:[]}},{key:"getTaskInfo",value:function(t,e){var a=this;console.log(e);var s=this["$createToast"]({time:0,txt:"加载..."});s.show(),this.$store.dispatch("getTaskInfo",{fleetId:t,departureTimeList:e}).then(function(t){if(console.log(t),t.success){var e=t.data;a.dataList=e.list}s.hide()})}},{key:"refresh",value:function(){this.getTaskInfo(this.fleetId,this.departureTimeList)}},{key:"addCar",value:function(){this.$router.push({name:"fleetTaskCarAdd",query:{backInfo:{type:"add"}}})}},{key:"updateCar",value:function(t,e){this.$router.push({name:"fleetTaskCarAdd",query:{backInfo:{type:"update",info:t,index:e}}})}},{key:"deleteCar",value:function(t){this.dataList.splice(t,1)}},{key:"getFormatTime",value:function(t){var e=new Date(t),a=e.getFullYear(),s=e.getMonth()+1,i=e.getDate(),r=e.getDay(),n=["日","一","二","三","四","五","六"],c=e.getHours(),o=c>=12?"下午":"上午",l=e.getMinutes(),u=(e.getSeconds(),"");return u+=a+"年 ",u+=(s<10?"0"+s:s)+"月"+(i<10?"0"+i:i)+"日",u+=" 周"+n[r],u+=o,u+=" "+(c<10?"0"+c:c)+":"+(l<10?"0"+l:l),u}},{key:"getTime",value:function(t){if(!this.showTimes)return"";var e="start"===this.currentTab?t:this.pointObj.start.length+t;if(!this.timeRows[e])return"";var a=this.timeRows[e][e+1];return a?"去下个点位  预估路程："+Math.floor(a.distance/1e3)+"公里  预估时间："+this.secondsToTime(a.duration):"此点为终点站~"}},{key:"secondsToTime",value:function(t){var e,a,s;e=Math.floor(t/3600),s=t%3600,a=Math.floor(s/60),s%=60;var i="";return e&&(i=i+e+"小时"),a&&(i=i+a+"分钟"),s&&(i=i+s+"秒"),i}},{key:"saveTask",value:function(){var t=this,e=this["$createToast"]({time:0,txt:"保存中..."});e.show(),this.$store.dispatch("updateTaskInfo",{type:"addCar",fleetId:this.fleetId,departureTime:this.departureTime,setInfo:{$set:{carList:this.dataList}}}).then(function(a){console.log(a),a.success?t.$createDialog({type:"alert",title:"操作提示",content:"关注分配通知消息，请勿多次保存！",icon:"cubeic-alert",onConfirm:function(){t.$router.back()}}).show():t.$createDialog({type:"alert",title:"操作提示",content:"添加失败！",icon:"cubeic-alert"}).show(),e.hide()})}},{key:"validate",value:function(){var t=this,e=!0,a="";return Object.keys(this.pointObj).forEach(function(s){0===t.pointObj[s].length?(e=!1,a="start"===s?"出发点位必填":"到达点位必填"):t.pointObj[s].forEach(function(t){t.point&&t.point.location||(e=!1,a=t.label+"未添加定位！")})}),e||this.$createDialog({type:"alert",title:"提示",content:a,icon:"cubeic-alert"}).show(),e}},{key:"addOrUpdatePoint",value:function(t){var e=this.pointObj[this.currentTab][t],a=e.point?"update":"add",s=this.currentTab;this.$router.push({name:"mapSelect",query:{backInfo:{updateIndex:t,updateType:s},location:"update"===a?e.point.location:[]}})}},{key:"deletePoint",value:function(t){var e=this,a="任务删除将不会恢复，请确认是否删除！",s=this.$createDialog({type:"confirm",title:"删除确认",content:a,confirmBtn:{text:"确认删除",active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:"取消",active:!1,disabled:!1,href:"javascript:;"},onConfirm:function(){e.dataList.splice(t,1)},onCancel:function(){}});s.show()}},{key:"updateDialotText",value:function(t,e){this.pointTextDialot(t,"update",e)}},{key:"pointTextDialot",value:function(t,e,a){this.$router.push({})}},{key:"navChange",value:function(t){console.log(t),this.currentTab=t}},{key:"showInfo",value:function(t){console.log("sssss",t),this.$router.push({name:"fleetOrderList",query:{fleetId:this.fleetId,departureTime:t.departureTime}})}},{key:"routeChange",value:function(t){var e=this.$store.state.backData;if("fleetTaskCarAdd"===e.route){var a=e.data,s=a.backInfo;"add"===s.type?(console.log(a.data,"soooooooooooooooooooo"),this.dataList.push(a.data)):this.$set(this.dataList,s.index,a.data),this.$store.commit("SET_BACK_DATA",{})}}},{key:"showTimes",get:function(){return this.timeRows&&this.timeRows.length>0}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])({default:"default value"})],f.prototype,"propB",void 0),Object(u["a"])([Object(d["d"])("$route")],f.prototype,"routeChange",null),f=Object(u["a"])([Object(d["a"])({components:{Page:h["a"],pageView:v["a"],navView:p["a"]}})],f);var b=f,m=b,k=(a("1bc9"),a("2877")),_=Object(k["a"])(m,s,i,!1,null,null,null);e["default"]=_.exports},"72ee":function(t,e,a){"use strict";var s=a("2b1f"),i=a.n(s);i.a},b13e:function(t,e,a){},c572:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{attrs:{type:"form-def",title:"订单列表",isBack:!0}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"screen-header"},[a("div",[a("span",{on:{click:t.screenOpen}},[t._v("筛选"),a("i",{class:t.openScreen?"cubeic-pullup":"cubeic-pulldown"})])]),a("div",{staticClass:"screen-search",on:{click:t.screenClick}},[t._v("搜索")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.openScreen,expression:"openScreen"}],staticClass:"screen"},[a("cube-input",{model:{value:t.start,callback:function(e){t.start=e},expression:"start"}},[a("span",{staticClass:"screen-span",attrs:{slot:"prepend"},slot:"prepend"},[t._v("起点")])]),a("cube-input",{model:{value:t.end,callback:function(e){t.end=e},expression:"end"}},[a("span",{staticClass:"screen-span",attrs:{slot:"prepend"},slot:"prepend"},[t._v("终点")])]),a("div",{staticClass:"screen-bottom"},[a("cube-button",{staticClass:"screen-bottom-btn",attrs:{inline:!0,light:!0},on:{click:t.screenReset}},[t._v("重置")]),a("cube-button",{staticClass:"screen-bottom-btn",attrs:{inline:!0},on:{click:t.screenOpen}},[t._v("确定")])],1)],1),a("cube-checkbox-group",{attrs:{shape:"square","hollow-style":!0},on:{checked:t.orderChecked,"cancel-checked":t.orderCancelChecked},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.orderList,function(e,s){return a("cube-checkbox",{key:s,staticClass:"checkbox",attrs:{option:e.out_trade_no+"@"+e.number+"@"+e.userId}},[a("p",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(e.start)+"-"+t._s(e.end))]),a("p",{staticClass:"number"},[t._v("人数:"+t._s(e.number))]),a("p",[t._v("联系电话: "+t._s(e.phone))]),a("p",[t._v("姓名: "+t._s(e.name))]),a("p",[t._v("身份证")]),t._l(e.riderList,function(e,s){return a("p",{key:s},[t._v("\r\n            "+t._s(e.idCard)+"\r\n          ")])}),e.point&&e.point.start?a("p",[t._v("上车点： "+t._s(e.point.start.label))]):t._e(),e.point&&e.point.end?a("p",[t._v("下车点： "+t._s(e.point.end.label))]):t._e()],2)}),1),a("cube-button",{directives:[{name:"show",rawName:"v-show",value:t.showMore,expression:"showMore"}],staticClass:"btn",on:{click:t.pageTurning}},[t._v("查看更多")]),a("p",{directives:[{name:"show",rawName:"v-show",value:!t.showMore,expression:"!showMore"}],staticClass:"noMore"},[t._v("没有更多了")]),a("div",{staticClass:"footer"}),a("cube-drawer",{ref:"drawer",attrs:{data:t.drawerdata,"selected-index":t.selectedIndex}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("车辆选择")]),a("cube-drawer-panel",{attrs:{data:t.drawerdata}},[t._l(t.drawerdata,function(e,s){return a("cube-drawer-item",{directives:[{name:"show",rawName:"v-show",value:e.id!==t.carId,expression:"item.id !== carId"}],key:s,attrs:{item:e,index:s}},[a("p",{on:{click:function(a){return t.drawerSelect(e)}}},[t._v("车牌："+t._s(e.licensePlate?e.licensePlate:"未填写"))])])}),a("cube-drawer-item",[a("span",[t._v("加载更多")])])],2)],1)],1)])},i=[],r=(a("28a5"),a("d225")),n=a("b0b4"),c=a("308d"),o=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),h=a("fdab"),v=a("07e8"),p=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(o["a"])(e).apply(this,arguments)),t.start="",t.end="",t.page=1,t.limit=10,t.count=0,t.carNums=0,t.checkList=[],t.orderList=[],t.selectNum=0,t.selectCarId="",t.drawerdata=[{}],t.selectedIndex=[],t.openScreen=!1,t.actions=[{text:"已选择：0人"},{text:"请选车辆",type:"button",action:"selectCar"},{text:"确认分配",type:"button",action:"distributionOrder"}],t}return Object(l["a"])(e,t),Object(n["a"])(e,[{key:"created",value:function(){this.checkList=[],this.selectNum=0,this.getOrderList({})}},{key:"getOrderList",value:function(t){var e=this,a=t.skip||0,s=(t.limit,this["$createToast"]({time:0,txt:"加载..."}));s.show(),this.$store.dispatch("getOrderList",{start:this.start,end:this.end,departureTime:this.departureTime,skip:a,fleetId:this.fleetId}).then(function(a){a.success&&(t.skip?e.orderList=e.orderList.concat(a.data.list):e.orderList=a.data.list,e.count=a.data.count),s.hide()})}},{key:"pageTurning",value:function(){if(this.showMore){this.page++;var t=(this.page-1)*this.limit;this.getOrderList({skip:t})}}},{key:"orderChecked",value:function(t){var e=t.split("@");this.selectNum+=parseInt(e[1]),this.actions[0].text="已选择："+this.selectNum+"人"}},{key:"orderCancelChecked",value:function(t){var e=t.split("@");this.selectNum-=parseInt(e[1]),this.actions[0].text="已选择："+this.selectNum+"人"}},{key:"clickHandler",value:function(t){"distributionOrder"===t.action?this.distributionOrder():"selectCar"===t.action&&this.selectCar()}},{key:"selectCar",value:function(){this.getCarList({})}},{key:"distributionOrder",value:function(){if(this.checkList.length<=0){var t=this.$createToast({time:1e3,txt:"请选择订单",type:"txt"});t.show()}else{if(!this.selectCarId){var e=this.$createToast({time:1e3,txt:"请选择要分配的车辆",type:"txt"});return e.show(),!1}this.orderAllocation()}}},{key:"getCarList",value:function(t){var e=this,a=t.skip||0,s=t.limit||10,i=(this.fleetId,this["$createToast"]({time:0,txt:"加载..."}));i.show(),console.log(this.fleetId,"fleetId"),console.log(this.$store.state);var r={skip:a,limit:s};(this.$store.state.user="13934691550")?console.log("user"):r.fleetId=this.fleetId,this.$store.dispatch("getCarList",r).then(function(t){t.success&&(e.drawerdata[0]?e.drawerdata=t.data.list:e.drawerdata=e.drawerdata.concat(t.data.list),e.count=t.data.count,e.$refs.drawer.show()),i.hide()})}},{key:"drawerSelect",value:function(t){this.selectCarId=t.id,this.actions[1].text=t.licensePlate?"车牌："+t.licensePlate:"车牌：未知",this.$refs.drawer.hide()}},{key:"resetComponentInfo",value:function(){this.page=1,this.count=0,this.orderList=[],this.selectCarId="",this.actions[1].text="请选车辆",this.actions[0].text="已选择：0人"}},{key:"orderAllocation",value:function(){var t=this;if(!(this.checkList.length<=0)&&this.selectCarId){var e=this["$createToast"]({time:0,txt:"订单分配中..."});e.show(),this.$store.dispatch("orderAllocation",{orderList:this.checkList,toCarId:this.selectCarId,carId:this.carId}).then(function(a){if(a.success){var s=t.$createToast({time:1e3,txt:"分配成功！",type:"txt"});s.show(),t.resetComponentInfo(),t.getOrderList({})}e.hide()})}}},{key:"screenClick",value:function(){this.getOrderList({})}},{key:"screenOpen",value:function(){this.openScreen=!this.openScreen}},{key:"screenReset",value:function(){this.start="",this.end=""}},{key:"showMore",get:function(){return Math.ceil(this.count/this.limit)>=this.page+1}},{key:"fleetId",get:function(){return this.$route.query.fleetId}},{key:"departureTime",get:function(){return this.$route.query.departureTime}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])({default:"default value"})],p.prototype,"propB",void 0),p=Object(u["a"])([Object(d["a"])({components:{HelloWorld:h["a"],Page:v["a"]}})],p);var f=p,b=f,m=(a("3c22"),a("2877")),k=Object(m["a"])(b,s,i,!1,null,null,null);e["default"]=k.exports},ca73:function(t,e,a){"use strict";var s=a("b13e"),i=a.n(s);i.a},fdab:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("h1",[t._v(t._s(t.msg))]),t._m(0),a("h3",[t._v("Installed CLI Plugins")]),t._m(1),a("h3",[t._v("Essential Links")]),t._m(2),a("h3",[t._v("Ecosystem")]),t._m(3)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("\n    For a guide and recipes on how to configure / customize this project,"),a("br"),t._v("\n    check out the\n    "),a("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-cli documentation")]),t._v(".\n  ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[t._v("babel")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-typescript",target:"_blank",rel:"noopener"}},[t._v("typescript")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint",target:"_blank",rel:"noopener"}},[t._v("eslint")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Core Docs")])]),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Forum")])]),a("li",[a("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Community Chat")])]),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[t._v("Twitter")])]),a("li",[a("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("News")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-router")])]),a("li",[a("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vuex")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[t._v("vue-devtools")])]),a("li",[a("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-loader")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[t._v("awesome-vue")])])])}],r=a("d225"),n=a("308d"),c=a("6bb5"),o=a("4e2b"),l=a("9ab4"),u=a("60a3"),d=function(t){function e(){return Object(r["a"])(this,e),Object(n["a"])(this,Object(c["a"])(e).apply(this,arguments))}return Object(o["a"])(e,t),e}(u["c"]);Object(l["a"])([Object(u["b"])()],d.prototype,"msg",void 0),d=Object(l["a"])([u["a"]],d);var h=d,v=h,p=(a("170f"),a("2877")),f=Object(p["a"])(v,s,i,!1,null,"13913fa2",null);e["a"]=f.exports}}]);
//# sourceMappingURL=fleetOrderList.42694633.js.map