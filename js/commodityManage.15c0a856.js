(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["commodityManage"],{"07e8":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cube-page",class:e.type},[i("header",{staticClass:"header"},[i("h1",[e._v(e._s(e.title))]),i("i",{directives:[{name:"show",rawName:"v-show",value:e.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:e.back}}),i("div",{staticClass:"header-edit"},[e._t("edit")],2)]),i("div",{class:{wrapper:!0,isWhite:"white"===e.type}},[i("section",{directives:[{name:"show",rawName:"v-show",value:e.desc,expression:"desc"}],staticClass:"desc"},[e._t("desc",[e._v(e._s(e.desc))])],2),i("main",{staticClass:"content"},[e._t("content",[e._v(e._s(e.content))])],2)])])},a=[],c=i("d225"),r=i("b0b4"),o=i("308d"),n=i("6bb5"),l=i("4e2b"),d=i("9ab4"),u=i("60a3"),m=function(e){function t(){return Object(c["a"])(this,t),Object(o["a"])(this,Object(n["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(r["a"])(t,[{key:"back",value:function(){this.$router.back()}}]),t}(u["c"]);Object(d["a"])([Object(u["b"])()],m.prototype,"msg",void 0),Object(d["a"])([Object(u["b"])({default:"",required:!0})],m.prototype,"title",void 0),Object(d["a"])([Object(u["b"])({default:""})],m.prototype,"type",void 0),Object(d["a"])([Object(u["b"])({default:""})],m.prototype,"desc",void 0),Object(d["a"])([Object(u["b"])({default:""})],m.prototype,"content",void 0),Object(d["a"])([Object(u["b"])({default:!0})],m.prototype,"isBack",void 0),m=Object(d["a"])([u["a"]],m);var b=m,p=b,f=(i("89d1"),i("2877")),v=Object(f["a"])(p,s,a,!1,null,"cbeccb54",null);t["a"]=v.exports},5102:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"file-upload"},[i("div",{staticClass:"file-upload-box"},[e._l(e.imageArr,function(t,s){return i("div",{key:t,staticClass:"img-box"},[i("img",{staticClass:"imgPriview",attrs:{src:t},on:{click:function(t){return e.handleImgsClick(s)}}}),i("i",{staticClass:"cubeic-wrong",on:{click:function(i){return e.imageRemove(t,s)}}})])}),i("cube-upload",{ref:"upload",attrs:{action:e.action,"simultaneous-uploads":1},on:{"files-added":e.filesAdded,"file-removed":e.fileRemove,"file-success":e.fileSuccess},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}},[i("div",{staticClass:"clear-fix"},[i("cube-upload-btn",{attrs:{multiple:!1}},[i("div",{staticClass:"cube-upload-btn-def"},[i("i")])])],1)])],2)])},a=[],c=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),r=i("d225"),o=i("b0b4"),n=i("308d"),l=i("6bb5"),d=i("4e2b"),u=i("9ab4"),m=i("60a3");function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,s)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(i,!0).forEach(function(t){Object(c["a"])(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var f=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(n["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.fileUrl="http://img.beijixiong.club:4869/",e.imageArr=[],e.action={target:"/fileUpload",data:{token:"rwwXO0wQq5SBEqP7"}},e.isUploading=!0,e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"upload",value:function(){this.isUploading=!0,this.$refs.upload.start()}},{key:"pause",value:function(){this.isUploading=!1,this.$refs.upload.pause()}},{key:"retry",value:function(){this.$refs.upload.retry()}},{key:"filesAdded",value:function(e){var t=!1,i=1048576;for(var s in e){var a=e[s];a.size>i&&(a.ignore=!0,t=!0)}t&&this.$createToast({type:"warn",time:2e3,txt:"文件需要小于1M"}).show()}},{key:"fileRemove",value:function(e){if(e.response&&e.response.md5){var t=this.fileUrl+e.response.md5,i=this.imageArr.indexOf(t);i>-1&&this.imageArr.splice(i,1)}}},{key:"fileSuccess",value:function(e){var t=e.response.md5,i=this.fileUrl+t,s=this.imageArr.indexOf(i);-1===s&&this.imageArr.push(i)}},{key:"handleImgsClick",value:function(e){var t=this;this.initialIndex=e;var i={$props:{imgs:this.imageArr,initialIndex:"initialIndex",loop:!1},$events:{change:function(e){t.initialIndex=e}}};this.$createImagePreview(p({},i)).show()}},{key:"imageArrChange",value:function(e){this.$emit("input",e)}},{key:"valueChange",value:function(e){this.$set(this,"imageArr",e)}},{key:"imageRemove",value:function(e,t){var i=this;this.$store.dispatch("removeImage",{url:e}).then(function(s){s.success&&(console.log(e),console.log("图片删除成功！")),i.imageArr.splice(t,1)})}}]),t}(m["c"]);Object(u["a"])([Object(m["b"])({default:[]})],f.prototype,"value",void 0),Object(u["a"])([Object(m["d"])("imageArr")],f.prototype,"imageArrChange",null),Object(u["a"])([Object(m["d"])("value",{immediate:!0})],f.prototype,"valueChange",null),f=Object(u["a"])([Object(m["a"])({components:{},filters:{}})],f);var v=f,h=v,y=(i("753f"),i("2877")),O=Object(y["a"])(h,s,a,!1,null,null,null);t["a"]=O.exports},"5c96":function(e,t,i){},6825:function(e,t,i){},"753f":function(e,t,i){"use strict";var s=i("7952"),a=i.n(s);a.a},7952:function(e,t,i){},"89d1":function(e,t,i){"use strict";var s=i("f242"),a=i.n(s);a.a},9116:function(e,t,i){"use strict";var s=i("5c96"),a=i.n(s);a.a},d6c5:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page",{attrs:{title:e.className,type:"white"}},[i("div",{attrs:{slot:"edit"},slot:"edit"},[i("span",{staticClass:"add-btn",on:{click:e.addCommodity}},[e._v("新增商品")])]),i("div",{attrs:{slot:"content"},slot:"content"},[i("ul",{staticClass:"commodity-list"},e._l(e.commodityList,function(t,s){return i("li",{key:s,staticClass:"commodity-card"},[i("div",[i("p",{staticClass:"title"},[e._v(e._s(t.name))]),i("p",{staticClass:"price"},[e._v("价格："+e._s(t.price)+"元")]),i("p",{staticClass:"price"},[e._v("单位："+e._s(t.unit))]),i("p",{staticClass:"class"},[e._v("分类："+e._s(e.className))])]),i("div",{staticClass:"edit"},[i("cube-button",{attrs:{inline:!0},on:{click:function(i){return e.editCommodity(t)}}},[e._v("编辑")])],1)])}),0),i("div",{directives:[{name:"show",rawName:"v-show",value:e.commodityList.length<=0,expression:"commodityList.length <= 0"}],staticClass:"empy"},[e._v("暂无数据")]),e.showAdd?i("commodityAdd",{staticClass:"commodity-add-box",attrs:{data:e.commodityObj,classId:e.classId},on:{cancel:e.addCancel,saveSuccess:e.saveSuccess}}):e._e()],1)])},a=[],c=i("d225"),r=i("b0b4"),o=i("308d"),n=i("6bb5"),l=i("4e2b"),d=i("9ab4"),u=i("60a3"),m=i("07e8"),b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("cube-form",{attrs:{model:e.model,"immediate-validate":!1,options:e.options},on:{validate:e.validateHandler,submit:e.submitHandler,reset:e.resetHandler}},[i("cube-form-group",{attrs:{legend:"商品添加"}},[i("cube-form-item",{attrs:{field:e.fields[0]}}),i("cube-form-item",{attrs:{field:e.fields[1]}}),i("cube-form-item",{attrs:{field:e.fields[2]}}),i("cube-form-item",{attrs:{field:e.fields[3]}}),i("cube-form-item",{attrs:{field:e.fields[4]}}),i("imageUpload",{model:{value:e.model.imgUrlList,callback:function(t){e.$set(e.model,"imgUrlList",t)},expression:"model.imgUrlList"}})],1),i("cube-form-group",[i("cube-button",{staticClass:"button",attrs:{type:"reset",inline:!0}},[e._v("取消")]),i("cube-button",{staticClass:"button",attrs:{type:"submit",inline:!0,primary:!0}},[e._v("保存")])],1)],1)],1)},p=[],f=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),v=i("5102");function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,s)}return i}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(i,!0).forEach(function(t){Object(f["a"])(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var O=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(o["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.model={name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]},e.fields=[{type:"input",modelKey:"name",label:"商品名称",props:{placeholder:"请输入"},rules:{required:!0},trigger:"blur"},{type:"input",modelKey:"price",label:"价格",props:{placeholder:"请输入价格"},rules:{required:!0,type:"number"},trigger:"blur"},{type:"select",modelKey:"unit",label:"单位",props:{options:["个","斤","件","箱","平米","条"]},rules:{required:!0}},{type:"switch",modelKey:"disabled",label:"是否上架"},{type:"input",modelKey:"number",label:"数量",props:{placeholder:"请输入数量"},rules:{type:"number",required:!0},trigger:"blur"}],e.options={scrollToInvalidField:!0,layout:"standard"},e}return Object(l["a"])(t,e),Object(r["a"])(t,[{key:"created",value:function(){this.data.id&&(this.model=this.data)}},{key:"validateHandler",value:function(){console.log("ddd")}},{key:"submitHandler",value:function(e){var t,i=this;e.preventDefault(),t=this.model.id?y({},this.model):y({},this.model,{businessId:"5693c8b0-f97f-11ea-8165-3111824eebe8",class:this.classId}),this.$store.dispatch("addOrUpdateCommodity",t).then(function(e){if(e.success){e.data?i.$emit("saveSuccess","add",e.data):i.$emit("saveSuccess","update",t);var s=i.$createToast({txt:"保存成功",time:3e3,type:"txt"});s.show()}})}},{key:"resetHandler",value:function(){this.$emit("cancel")}}]),t}(u["c"]);Object(d["a"])([Object(u["b"])({default:""})],O.prototype,"classId",void 0),Object(d["a"])([Object(u["b"])({default:{name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]}})],O.prototype,"data",void 0),O=Object(d["a"])([Object(u["a"])({components:{page:m["a"],imageUpload:v["a"]}})],O);var g=O,j=g,w=(i("9116"),i("2877")),k=Object(w["a"])(j,b,p,!1,null,"90b65cce",null),C=k.exports,_=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(o["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.classId="",e.className="",e.commodityList=[],e.showAdd=!1,e.commodityObj={name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]},e}return Object(l["a"])(t,e),Object(r["a"])(t,[{key:"activated",value:function(){var e=this.$route.query;this.classId=e.id,this.className=e.name,this.showAdd=!1}},{key:"deactivated",value:function(){this.classId="",this.$set(this,"commodityList",[])}},{key:"idChange",value:function(e){e&&this.getCommodityListByClassId()}},{key:"getCommodityListByClassId",value:function(){var e=this;if(this.classId){var t=this["$createToast"]({time:0,txt:"商品获取中..."});t.show(),this.$store.dispatch("getCommodityListByClassId",{class:this.classId,page:1}).then(function(i){if(i.success){var s=i.data.list;e.$set(e,"commodityList",s),t.hide()}})}}},{key:"addCommodity",value:function(){this.commodityObj={name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]},this.showAdd=!0}},{key:"addCancel",value:function(){this.showAdd=!1}},{key:"saveSuccess",value:function(e,t){var i;"add"===e?this.commodityList.push(t):(this.commodityList.some(function(e,i){if(t.id===e.id)return i=i,!0}),this.$set(this.commodityList,i,t));this.addCancel()}},{key:"editCommodity",value:function(e){this.commodityObj=e,this.showAdd=!0}},{key:"mounted",value:function(){}}]),t}(u["c"]);Object(d["a"])([Object(u["d"])("classId")],_.prototype,"idChange",null),_=Object(d["a"])([Object(u["a"])({components:{page:m["a"],commodityAdd:C}})],_);var $=_,x=$,I=(i("f243"),Object(w["a"])(x,s,a,!1,null,"778d6315",null));t["default"]=I.exports},f242:function(e,t,i){},f243:function(e,t,i){"use strict";var s=i("6825"),a=i.n(s);a.a}}]);
//# sourceMappingURL=commodityManage.15c0a856.js.map