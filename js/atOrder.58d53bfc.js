(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["atOrder"],{"035a":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("div",{staticClass:"app-box"},[i("keep-alive",[i(t.selectedLabelDefault,{tag:"component"})],1)],1),i("div",{staticClass:"app-tab"},[i("cube-tab-bar",{on:{click:t.clickHandler,change:t.changeHandler},model:{value:t.selectedLabelDefault,callback:function(e){t.selectedLabelDefault=e},expression:"selectedLabelDefault"}},t._l(t.tabs,function(e,n){return i("cube-tab",{key:n,attrs:{label:e.value}},[i("div",[i("i",{class:["iconfont",e.icon],attrs:{slot:"icon"},slot:"icon"})]),i("div",{staticClass:"label"},[t._v(t._s(e.label))])])}),1)],1)])},a=[],s=i("d225"),o=i("b0b4"),r=i("308d"),c=i("6bb5"),u=i("4e2b"),l=i("9ab4"),d=i("60a3"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[t._v("\n  "+t._s(t.sessionId)+"\n  "),i("div",{staticClass:"app-con"},[i("div",{staticClass:"app-con-tit"},[t._v("营销拓客")]),i("div",{staticClass:"app-con-box"},t._l(t.appList,function(e,n){return i("div",{key:n,staticClass:"app-block",on:{click:function(i){return t.appClick(e)}}},[i("div",{staticClass:"icon"},[i("i",{class:["iconfont",e.icon]})]),i("div",{staticClass:"label"},[t._v(t._s(e.label))])])}),0)])])},f=[],m=i("319c"),h=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(r["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.sessionId="",t.appList=[{icon:"iconshangpin",label:"商品管理",path:"/shopList"},{icon:"iconshangpin",label:"在线传单"},{icon:"iconshangpin",label:"群发短信"},{icon:"iconshangpin",label:"客户"},{icon:"iconshangpin",label:"群活码"}],t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){this.sessionId=this.$route.query.sessionId}},{key:"appClick",value:function(t){t.path&&this.$router.push({path:t.path,query:{state:"business@8a146790-f97e-11ea-8165-3111824eebe8"}})}}]),e}(d["c"]);h=Object(l["a"])([Object(d["a"])({components:{banner:m["a"]}})],h);var b=h,y=b,v=(i("a7bc"),i("2877")),g=Object(v["a"])(y,p,f,!1,null,"76b16261",null),C=g.exports,O=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(r["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.selectedLabelDefault="appList",t.tabs=[{label:"工作中心",icon:"icon_yingyong",value:"appList"},{label:"我的",icon:"icon_gongzhonghao",value:"myconfig"}],t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"clickHandler",value:function(t){console.log(t)}},{key:"changeHandler",value:function(t){}}]),e}(d["c"]);O=Object(l["a"])([Object(d["a"])({components:{appList:C}})],O);var k=O,j=k,_=(i("afac"),Object(v["a"])(j,n,a,!1,null,"f944ae40",null));e["default"]=_.exports},"0753":function(t,e,i){},"18a0":function(t,e,i){t.exports=i("574f")("./node_modules/weixin-js-sdk/index.js")},2158:function(t,e,i){},"319c":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"slide-banner"},[i("cube-slide",{attrs:{data:t.imgUrl}})],1)},a=[],s=(i("ac6a"),i("d225")),o=i("b0b4"),r=i("308d"),c=i("6bb5"),u=i("4e2b"),l=i("9ab4"),d=i("60a3"),p=function(t){function e(){return Object(s["a"])(this,e),Object(r["a"])(this,Object(c["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"imgUrl",get:function(){if(this.url&&"string"===typeof this.url)return[{image:this.url}];if(Array.isArray(this.url)){var t=[];return this.url.forEach(function(e){t.push({image:e})}),t}return[]}}]),e}(d["c"]);Object(l["a"])([Object(d["b"])({default:""})],p.prototype,"url",void 0),p=Object(l["a"])([Object(d["a"])({components:{},filters:{}})],p);var f=p,m=f,h=(i("5016"),i("72a9"),i("2877")),b=Object(h["a"])(m,n,a,!1,null,"2d55a1be",null);e["a"]=b.exports},"47d5":function(t,e,i){"use strict";var n=i("5d86"),a=i.n(n);a.a},"4c70":function(t,e,i){"use strict";var n=i("d172"),a=i.n(n);a.a},5016:function(t,e,i){"use strict";var n=i("fc70"),a=i.n(n);a.a},"5c5d":function(t,e,i){},"5d86":function(t,e,i){},"72a9":function(t,e,i){"use strict";var n=i("0753"),a=i.n(n);a.a},"7e52":function(t,e,i){},a027:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"atOrder"},[i("previewOrder"),i("payClick",{attrs:{actions:t.actions},on:{click:t.clickHandler}})],1)},a=[],s=(i("ac6a"),i("96cf"),i("3b8d")),o=(i("a481"),i("28a5"),i("d225")),r=i("b0b4"),c=i("308d"),u=i("6bb5"),l=i("4e2b"),d=i("9ab4"),p=i("60a3"),f=i("18a0"),m=i.n(f),h=i("da92"),b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:{isAtOrder:!0}},[i("div",{ref:"selectlist",staticClass:"atOrderBox"},[i("p",{staticClass:"atOrderBox-title"},[t._v("订单确认")]),i("div",{style:t.autoHeight},[i("cube-scroll",{ref:"atScroll",attrs:{data:t.selectCommodityList,options:t.options}},[i("ul",{staticClass:"foods-wrapper"},t._l(t.selectCommodityList,function(e,n){return i("li",{staticClass:"atOrderBox-li"},[i("div",{staticClass:"image"},[i("img",{attrs:{src:e.imgUrlList&&e.imgUrlList.length>0?e.imgUrlList[0]+"?w=100":""}})]),i("div",{staticClass:"atOrderBox-info"},[i("div",{staticClass:"atOrderBox-info-name"},[i("span",{staticClass:"name"},[t._v(t._s(e.name))]),i("span",{staticClass:"price"},[t._v(t._s(t.getFoodPrice(e)))])]),i("div",{staticClass:"atOrderBox-info-num"},[i("span",[t._v("数量:"+t._s(e.num)+t._s(e.unit))])])])])}),0)])],1),i("div",{staticClass:"atOrderBox-bottom"},[i("span",{staticStyle:{"margin-left":"3px"}},[t._v("小计")]),t._v(t._s(t.selectCommodityPrice))])])])},y=[],v=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.autoHeight={height:"auto"},t}return Object(l["a"])(e,t),Object(r["a"])(e,[{key:"activated",value:function(){this.isShowChange(!0)}},{key:"getFoodPrice",value:function(t){return"¥"+h["a"].strip(t.num*t.price)}},{key:"foodAdd",value:function(t,e){var i=t.num||0;this.$set(this.selectCommodityList[e],"num",i+1),this.$store.commit("SET_SELECT_COMMODITY_LIST",{type:"add",item:this.selectCommodityList[e]});var n=t.class;this.setClassNum(n,"add")}},{key:"setClassNum",value:function(t,e){this.$store.commit("SET_SELECT_COMMODITY_NUM",{classId:t,type:e})}},{key:"foodReduce",value:function(t,e){t.num;var i=t.num-1;this.$set(this.selectCommodityList[e],"num",i),this.$store.commit("SET_SELECT_COMMODITY_LIST",{type:"reduce",item:this.selectCommodityList[e]});var n=t.class;this.setClassNum(n,"reduce")}},{key:"isShowChange",value:function(t){this.selectCommodityList.length>3?this.autoHeight.height="274px":this.autoHeight.height="auto",this.$nextTick(function(){this.$refs.atScroll.refresh()})}},{key:"emptyCommodity",value:function(){this.$store.commit("EMPTY_COMMODITY")}},{key:"options",get:function(){return{pullDownRefresh:!1,pullUpLoad:!1,scrollbar:{fade:!1}}}},{key:"selectCommodityList",get:function(){return this.$store.state.selectCommodityList}},{key:"commodityNum",get:function(){var t=0;return this.$store.state.selectCommodityList.forEach(function(e){return t+=e.num}),t}},{key:"selectCommodityPrice",get:function(){var t=0;return this.$store.state.selectCommodityList.forEach(function(e){t+=e.price*e.num}),"¥"+h["a"].strip(t)}}]),e}(p["c"]);Object(d["a"])([Object(p["b"])({default:!1})],v.prototype,"isShow",void 0),Object(d["a"])([Object(p["d"])("selectCommodityList")],v.prototype,"isShowChange",null),v=Object(d["a"])([Object(p["a"])({components:{},filters:{getFoodNum:function(t){return t.num&&t.num>0?t.num:0}}})],v);var g=v,C=g,O=(i("4c70"),i("2877")),k=Object(O["a"])(C,b,y,!1,null,"e5f96cba",null),j=k.exports,_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolbar"},[i("span",{staticClass:"price"},[t._v(t._s(t.actions[0].text))]),i("div",{staticClass:"btn",on:{click:t.paymentClick}},[t._v("下单并支付")])])},I=[],w=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(r["a"])(e,[{key:"mounted",value:function(){}},{key:"paymentClick",value:function(){this.$emit("click",{action:"payButtonClickHandle"})}},{key:"shoppingClick",value:function(){this.commodityNum>0&&this.$emit("click",{action:"shoppingClick"})}},{key:"commodityNum",get:function(){var t=0;return this.$store.state.selectCommodityList.forEach(function(e){return t+=e.num}),t}}]),e}(p["c"]);Object(d["a"])([Object(p["b"])({default:""})],w.prototype,"actions",void 0),w=Object(d["a"])([Object(p["a"])({components:{},filters:{}})],w);var x=w,$=x,L=(i("a4ed"),Object(O["a"])($,_,I,!1,null,"421c7ac2",null)),S=L.exports,E=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.indicator=!1,t.model={phone:"",openid:""},t.actions=[{text:"¥00.00",action:"moreMoney"},{type:"button",text:'<div class="payButton">立即购买</div>',action:"payButtonClickHandle"}],t.page=1,t.commodityId="",t.commodityObj={},t.commodityNum=1,t.totalCost=0,t.userInfo={phone:"",address:""},t.openid="",t.payButtonClick=!1,t.weixinInfo={},t.payShowVisible=!1,t}return Object(l["a"])(e,t),Object(r["a"])(e,[{key:"activated",value:function(){this.$store.commit("SET_SESSION_ID","noSession");var t=this.$route.query.userInfo;this.openid=this.$route.query.openid,this.$set(this,"userInfo",t),this.actions[0].text="¥"+this.selectCommodityPrice}},{key:"selectCommodityListChanged",value:function(t){this.actions[0].text="¥"+t}},{key:"getUserInfo",value:function(){var t=this,e=this.$route.query;if(e.code){var i=this["$createToast"]({time:0,txt:"数据获取中..."});i.show(),this.$store.dispatch("getCommodityUserInfo",{code:e.code}).then(function(e){e.success&&e.data.openid&&(t.openid=e.data.openid,t.getWeiXinConfig(),e.data.userInfo&&(t.userInfo=e.data.userInfo),e.data.weixinInfo&&(t.weixinInfo=e.data.weixinInfo)),i.hide()})}else console.log("不是微信登陆")}},{key:"pageInit",value:function(){var t=this.$route.query,e=t.state;if(e){var i=e.split("@");"commodity"===i[0]&&(this.commodityId=i[1].replace(/\'/g,""))}t.code&&this.getUserInfo()}},{key:"getCommodityById",value:function(){var t=this,e=this["$createToast"]({time:0,txt:"数据获取中..."});e.show(),this.$store.dispatch("getCommodityById",{id:this.commodityId}).then(function(i){i.success&&t.$set(t,"commodityObj",i.data),e.hide()})}},{key:"fenToYuan",value:function(t){return"number"!==typeof t||isNaN(t)?null:"合计 ¥"+h["a"].strip((t/100).toFixed(2))}},{key:"getWeiXinConfig",value:function(){var t=window.location.href;this.$store.dispatch("getWeixinConfig",{url:t}).then(function(t){if(console.log("获取微信配置成功",t),t.success){var e=t.data;m.a.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["chooseWXPay"]})}m.a.ready(function(){}),m.a.error(function(t){})})}},{key:"clickHandler",value:function(t){t.action&&this[t.action](t)}},{key:"payButtonClickHandle",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,i,n,a,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.payButtonClick=!0,e=[],console.log(this.$store.state.selectCommodityList),this.$store.state.selectCommodityList.forEach(function(t){var i={};i.id=t.id,i.name=t.name,i.num=t.num,i.price=t.price,i.imgUrl=t.imgUrlList[0],e.push(i)}),console.log(this.$store.state.businessId,"this.$store.state.businessId"),!(e.length<=0)){t.next=9;break}return i=this.$createToast({txt:"请选择商品",type:"error"}),i.show(),t.abrupt("return");case 9:return console.log("type=commodity&commodityList="+JSON.stringify(e)+"&fee="+this.selectCommodityPrice+"&businessId="+this.$store.state.businessId),t.next=12,this.getIsMiniProgram();case 12:if(n=t.sent,!n){t.next=16;break}return m.a.miniProgram.navigateTo({url:"/pages/jumbprocess/index?type=commodity&commodityList="+JSON.stringify(e)+"&fee="+this.selectCommodityPrice+"&businessId="+this.$store.state.businessId}),t.abrupt("return");case 16:this.userInfo.phone&&this.userInfo.address?(a=this,s={},s.fee=this.selectCommodityPrice,s.body="集合订单",s.openid=this.openid,s.commodityList=e,s.businessId=this.$store.state.businessId,this.$store.dispatch("setCommodityOrder",s).then(function(t){if(t.success){var e=t.data;m.a.chooseWXPay({timestamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(t){a.payButtonClick=!1;var e=a.$createToast({time:2e3,txt:"订单处理中...",mask:!0,onTimeout:function(){a.$router.replace({path:"/paySuccess",query:{openid:a.openid}})}});e.show()},error:function(){}})}})):this.$router.push({path:"/orderConfirm",query:{userInfo:this.userInfo,openid:this.openid}});case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"shoppingClick",value:function(){this.payShowVisible=!this.payShowVisible}},{key:"payShowCancel",value:function(){this.payShowVisible=!1}},{key:"getIsMiniProgram",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){m.a.miniProgram.getEnv(function(e){t(e.miniprogram)})}));case 1:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}()},{key:"selectCommodityPrice",get:function(){var t=0;return this.$store.state.selectCommodityList.forEach(function(e){t+=e.price*e.num}),h["a"].strip(t)}},{key:"computedMsg",get:function(){return"computed "+this.propB}}]),e}(p["c"]);Object(d["a"])([Object(p["d"])("selectCommodityPrice")],E.prototype,"selectCommodityListChanged",null),Object(d["a"])([Object(p["b"])({default:"default value"})],E.prototype,"propB",void 0),E=Object(d["a"])([Object(p["a"])({components:{previewOrder:j,payClick:S},filters:{getFormatDate:function(t){return new Date(t).getFullYear()+"年"+(new Date(t).getMonth()+1)+"月"+new Date(t).getDate()},fenToYuan:function(t){return"number"!==typeof t||isNaN(t)?null:"¥"+(t/100).toFixed(2)}}})],E);var T=E,M=T,N=(i("bdbd"),i("47d5"),Object(O["a"])(M,n,a,!1,null,"d3886320",null));e["default"]=N.exports},a4ed:function(t,e,i){"use strict";var n=i("7e52"),a=i.n(n);a.a},a6c9:function(t,e,i){},a7bc:function(t,e,i){"use strict";var n=i("a6c9"),a=i.n(n);a.a},afac:function(t,e,i){"use strict";var n=i("5c5d"),a=i.n(n);a.a},b0b4:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("85f2"),a=i.n(n);function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),a()(t,n.key,n)}}function o(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}},bdbd:function(t,e,i){"use strict";var n=i("2158"),a=i.n(n);a.a},d172:function(t,e,i){},da92:function(t,e,i){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function n(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,r=s.length;o<r;o++,a++)n[a]=s[o];return n}function a(t,e){return void 0===e&&(e=15),+parseFloat(Number(t).toPrecision(e))}function s(t){var e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-+(e[1]||0);return i>0?i:0}function o(t){if(-1===t.toString().indexOf("e"))return Number(t.toString().replace(".",""));var e=s(t);return e>0?a(Number(t)*Math.pow(10,e)):Number(t)}function r(t){f&&(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)&&console.warn(t+" is beyond boundary when transfer to integer, the results may not be accurate")}function c(t,e){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];if(i.length>0)return c.apply(void 0,n([c(t,e),i[0]],i.slice(1)));var u=o(t),l=o(e),d=s(t)+s(e),p=u*l;return r(p),p/Math.pow(10,d)}function u(t,e){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];if(i.length>0)return u.apply(void 0,n([u(t,e),i[0]],i.slice(1)));var o=Math.pow(10,Math.max(s(t),s(e)));return(c(t,o)+c(e,o))/o}function l(t,e){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];if(i.length>0)return l.apply(void 0,n([l(t,e),i[0]],i.slice(1)));var o=Math.pow(10,Math.max(s(t),s(e)));return(c(t,o)-c(e,o))/o}function d(t,e){for(var i=[],u=2;u<arguments.length;u++)i[u-2]=arguments[u];if(i.length>0)return d.apply(void 0,n([d(t,e),i[0]],i.slice(1)));var l=o(t),p=o(e);return r(l),r(p),c(l/p,a(Math.pow(10,s(e)-s(t))))}function p(t,e){var i=Math.pow(10,e);return d(Math.round(c(t,i)),i)}var f=!0;function m(t){void 0===t&&(t=!0),f=t}var h={strip:a,plus:u,minus:l,times:c,divide:d,round:p,digitLength:s,float2Fixed:o,enableBoundaryChecking:m};e["a"]=h},fc70:function(t,e,i){}}]);
//# sourceMappingURL=atOrder.58d53bfc.js.map