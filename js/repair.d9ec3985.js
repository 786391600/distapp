(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["repair"],{"5c25":function(e,t,s){"use strict";var a=s("774c"),i=s.n(a);i.a},"60d6":function(e,t,s){"use strict";var a=s("e481"),i=s.n(a);i.a},"774c":function(e,t,s){},d470:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"repair"},[s("div",{staticClass:"swipe-wrapper"},[s("cube-tab-bar",{attrs:{data:e.tabBarList},on:{change:e.tabBarChange},model:{value:e.selectedLabelDefault,callback:function(t){e.selectedLabelDefault=t},expression:"selectedLabelDefault"}}),"repair"===this.selectedLabelDefault?s("div",{staticClass:"repair"},[s("div",{staticClass:"address"},[s("div",{staticClass:"info"},[s("i",{staticClass:"iconfont iconxiaoqu1"}),s("cube-select",{attrs:{title:e.title,options:e.houseOptions,placeholder:e.placeholder,"auto-pop":e.autoPop,disabled:e.disabled},on:{change:e.houseChange},model:{value:e.houseId,callback:function(t){e.houseId=t},expression:"houseId"}})],1)]),s("div",{staticClass:"userInfo"},[s("cube-input",{attrs:{disabled:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[e._v("\n                报修人\n              ")]},proxy:!0}],null,!1,164283956),model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}}),s("cube-input",{attrs:{disabled:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[e._v("\n                手机号\n              ")]},proxy:!0}],null,!1,2138541475),model:{value:e.userInfo.phone,callback:function(t){e.$set(e.userInfo,"phone",t)},expression:"userInfo.phone"}})],1),s("div",[s("cube-form",{staticClass:"home-form",attrs:{model:e.model,options:e.options},on:{validate:e.validateHandler,submit:e.submitHandler}},[s("cube-form-group",[s("div",[s("cube-form-item",{attrs:{field:e.fields[0]}})],1),s("div",[s("cube-form-item",{attrs:{field:e.fields[1]}})],1)]),s("cube-form-group",[s("cube-button",{staticClass:"submit",attrs:{type:"submit"}},[e._v("点击报修")])],1)],1)],1)]):e._e(),"repairList"===this.selectedLabelDefault?s("div",{staticClass:"repairList"},[e._l(e.repairList,function(t){return s("div",{staticClass:"repairList-box"},[s("div",{staticClass:"repairList-box-head"},[e._v(e._s(e._f("getFormatDate")(t.time)))]),s("div",{staticClass:"repairList-box-box"},[s("div",[s("span",{staticClass:"title"},[e._v("报修类型")]),s("span",[e._v(e._s(e._f("getRepairType")(t.type)))])]),s("div",[s("span",{staticClass:"title"},[e._v("报修人")]),s("span",[e._v(e._s(t.name))])]),s("div",[s("span",{staticClass:"title"},[e._v("报修详情")]),s("span",[e._v(e._s(t.details))])]),s("div",[s("span",{staticClass:"title"},[e._v("报修地址")]),s("span",[e._v(e._s(t.address))])])])])}),"repairList"===e.selectedLabelDefault&&e.isShowMore?s("div",{staticClass:"more",on:{click:e.showMoreClick}},[e._v("加载更多")]):e._e(),"repairList"!==e.selectedLabelDefault||e.isShowMore?e._e():s("div",{staticClass:"more"},[e._v("没有数据了")])],2):e._e()],1)])},i=[],o=(s("ac6a"),s("a481"),s("d225")),n=s("b0b4"),r=s("308d"),l=s("6bb5"),u=s("4e2b"),d=s("9ab4"),c=s("60a3"),p=s("fdab"),h=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(r["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.model={details:"",type:"type1"},e.fields=[{type:"textarea",modelKey:"details",props:{placeholder:"请描述您要报修的详情...",maxlength:"100",autoExpand:!0,autofocus:!0},rules:{required:!0},messages:{required:"请输入报修内容"}},{type:"select",modelKey:"type",label:"报修类型",props:{placeholder:"请输入",type:"text",options:[{text:"开锁服务",value:"type1"},{text:"公共报修",value:"type2"},{text:"个人报修",value:"type3"}]}}],e.houseId="",e.selectedLabelDefault="repair",e.tabBarList=[{label:"快捷报修",value:"repair"},{label:"报修记录",value:"repairList"}],e.page=1,e.isShowMore=!0,e.repairList=[],e}return Object(u["a"])(t,e),Object(n["a"])(t,[{key:"activated",value:function(){this.pageInit()}},{key:"validateHandler",value:function(e){this.validity=e.validity,this.valid=e.valid,console.log(e),console.log("validity",e.validity,e.valid,e.dirty,e.firstInvalidFieldIndex)}},{key:"getBindingInfo",value:function(){var e=this,t=this.$route.query;if(t.code){var s=this["$createToast"]({time:0,txt:"数据获取中..."});s.show(),this.$store.dispatch("getCodeInfo",{code:t.code}).then(function(t){t.success&&(t.data.openid?(e.openid=t.data.openid,e.$router.replace({path:"/login",query:{openid:t.data.openid,jump:"/home"}})):t.data.sessionId&&(e.$store.commit("SET_SESSION_ID",t.data.sessionId),e.$store.commit("SET_USER_INFO",t.data.userInfo),e.getHouseList())),s.hide()})}else console.log("不是微信登陆")}},{key:"pageInit",value:function(){var e=this.$route.query;e.houseId&&(this.houseId=e.houseId),this.$store.state.sessionId&&!this.houseId?this.getHouseList():e.code&&!this.$store.state.sessionId&&this.getBindingInfo()}},{key:"getHouseList",value:function(){var e=this;this.$store.dispatch("getHouseList",{}).then(function(t){t.data.list&&(e.listData=t.data.list,e.houseId||(e.houseId=e.listData[0].id),e.$store.commit("SET_HOUSE_LIST",e.listData))})}},{key:"tabBarChange",value:function(e){"repairList"===e&&(this.page=1,this.repairList=[],this.getRepairList())}},{key:"showMoreClick",value:function(){this.page++,this.getBillListByHouseId()}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault();var s=this.getHouseInfo(),a={};a.accountId=s.accountId,a.address=s.text,a.houseId=s.id,a.floorId=s.floorId,a.type=this.model.type,a.details=this.model.details,this.$store.dispatch("addRepair",a).then(function(e){e.success&&(t.model={details:"",type:"type1"},t.selectedLabelDefault="repairList",t.tabBarChange("repairList"),t["$createDialog"]({type:"alert",content:"报修成功, 随后会有工作人员联系您！",icon:"cubeic-ok"}).show())})}},{key:"getHouseInfo",value:function(){var e=this,t={};return this.$store.state.houseList.forEach(function(s){s.id===e.houseId&&(t=s)}),t}},{key:"getRepairList",value:function(){var e=this,t=this["$createToast"]({time:0,txt:"数据获取中..."});t.show(),this.$store.dispatch("getRepairList",{page:this.page,houseId:this.houseId}).then(function(s){s.success&&(s.data.list.length>0?e.repairList=e.repairList.concat(s.data.list):e.isShowMore=!1),t.hide()})}},{key:"showMoreClick",value:function(){this.page++,this.getRepairList()}},{key:"houseOptions",get:function(){return this.$store.state.houseList.forEach(function(e){e.value=e.id,e.text=e.account_info[0].name+" "+e.build_info[0].name+" "+e.unitNum+"单元"+e.floorNum+"层"+e.roomNum+"室"}),this.$store.state.houseList}},{key:"userInfo",get:function(){return this.$store.state.userInfo}}]),t}(c["c"]);Object(d["a"])([Object(c["b"])({default:"default value"})],h.prototype,"propB",void 0),h=Object(d["a"])([Object(c["a"])({components:{HelloWorld:p["a"]},filters:{getFormatDate:function(e){return new Date(e).getFullYear()+"年"+(new Date(e).getMonth()+1)+"月"+new Date(e).getDate()+"号"},getRepairType:function(e){return"type1"===e?"开锁服务":"type2"===e?"公共报修":"type3"===e?"个人报修":"其他报修"}}})],h);var f=h,v=f,b=(s("5c25"),s("60d6"),s("2877")),m=Object(b["a"])(v,a,i,!1,null,"28a9a757",null);t["default"]=m.exports},e481:function(e,t,s){}}]);
//# sourceMappingURL=repair.d9ec3985.js.map