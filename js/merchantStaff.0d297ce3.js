(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["merchantStaff"],{"07e8":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cube-page",class:t.type},[s("header",{staticClass:"header"},[s("h1",[t._v(t._s(t.title))]),s("i",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:t.back}}),s("div",{staticClass:"header-edit"},[t._t("edit")],2)]),s("div",{class:{wrapper:!0,isWhite:"white"===t.type}},[s("main",{staticClass:"content"},[t._t("content",[t._v(t._s(t.content))])],2)])])},a=[],n=s("d225"),o=s("b0b4"),c=s("308d"),r=s("6bb5"),u=s("4e2b"),l=s("9ab4"),d=s("60a3"),b=function(t){function e(){return Object(n["a"])(this,e),Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"back",value:function(){this.$router.go(-1)}},{key:"created",value:function(){console.log("创建page ===")}}]),e}(d["c"]);Object(l["a"])([Object(d["b"])()],b.prototype,"msg",void 0),Object(l["a"])([Object(d["b"])({default:"",required:!0})],b.prototype,"title",void 0),Object(l["a"])([Object(d["b"])({default:""})],b.prototype,"type",void 0),Object(l["a"])([Object(d["b"])({default:""})],b.prototype,"desc",void 0),Object(l["a"])([Object(d["b"])({default:""})],b.prototype,"content",void 0),Object(l["a"])([Object(d["b"])({default:!0})],b.prototype,"isBack",void 0),b=Object(l["a"])([Object(d["a"])({})],b);var h=b,f=h,p=(s("70dd"),s("2877")),v=Object(p["a"])(f,i,a,!1,null,"683234d3",null);e["a"]=v.exports},"200f":function(t,e,s){"use strict";var i=s("f4e0"),a=s.n(i);a.a},"35c0":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"fade"}},[t.visible?s("div",{staticClass:"edit-box"},[t._t("default")],2):t._e()])},a=[],n=s("d225"),o=s("b0b4"),c=s("308d"),r=s("6bb5"),u=s("4e2b"),l=s("9ab4"),d=s("60a3"),b=function(t){function e(){return Object(n["a"])(this,e),Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){}},{key:"hide",value:function(){this.$emit("update:visible",!1)}}]),e}(d["c"]);Object(l["a"])([Object(d["b"])({default:!1})],b.prototype,"visible",void 0),b=Object(l["a"])([Object(d["a"])({components:{}})],b);var h=b,f=h,p=(s("fa15"),s("2877")),v=Object(p["a"])(f,i,a,!1,null,"d5ca93a2",null);e["a"]=v.exports},"47b6":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("page",{attrs:{title:t.className}},[s("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"user-list"},t._l(t.businessUserList,function(e,i){return s("div",{key:e.phone,staticClass:"user-box"},[s("div",{staticClass:"title"},[t._v(t._s(e.name||"店员"+i))]),s("div",{staticClass:"oprate"},[s("span",{on:{click:function(s){return t.testSend(e)}}},[t._v("测试推送")]),"13934691550"!==e.bindPhone?s("span",{staticClass:"delete",on:{click:function(s){return t.deleteUser(e)}}},[t._v("删除店员")]):t._e(),s("span",{on:{click:function(s){return t.editUser(e)}}},[t._v("修改信息")])])])}),0),s("div",{staticClass:"add-user",on:{click:t.addUser}},[t._v("+添加店员")]),s("editBox",{ref:"addForm1",attrs:{visible:t.showEditbox},on:{"update:visible":function(e){t.showEditbox=e}}},[s("addForm",{ref:"addForm",attrs:{shopId:t.shopId,shopName:t.shopName},on:{cancel:function(e){t.showEditbox=!1},success:t.addSuccess}})],1)],1)])},a=[],n=s("d225"),o=s("b0b4"),c=s("308d"),r=s("6bb5"),u=s("4e2b"),l=s("9ab4"),d=s("60a3"),b=s("07e8"),h=s("51f3"),f=s("35c0"),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("cube-form",{attrs:{model:t.model,schema:t.schema,"immediate-validate":!1,options:t.options},on:{validate:t.validateHandler,submit:t.submitHandler,reset:t.resetHandler}})},v=[],m=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.validity={},t.valid=void 0,t.model={name:t.shopName+"-店员"+parseInt(10*Math.random(),10),phone:"",shopId:t.shopId},t.isEdit=!1,t.schema={groups:[{legend:"店员添加",fields:[{type:"input",modelKey:"name",label:"名称",props:{placeholder:"请输入"},rules:{required:!0},trigger:"blur",messages:{required:"店员名称必填"}},{type:"input",modelKey:"phone",label:"手机号",props:{placeholder:"请输入"},rules:{required:!0,type:"tel"},messages:{required:"手机号必填"},trigger:"blur"}]},{fields:[{type:"submit",label:"保存"},{type:"reset",label:"取消"}]}]},t.options={scrollToInvalidField:!0,layout:"classic"},t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"resetHandler",value:function(){this.$emit("cancel")}},{key:"submitHandler",value:function(t){var e=this;t.preventDefault();var s=this.isEdit?"updateBusinessUser":"addBusinessUser",i=this.isEdit?"修改成功！":"添加成功";this.$store.dispatch(s,this.model).then(function(t){t.message&&(i=t.message),e.$emit("success",i)})}},{key:"setData",value:function(t){var e=t.shopId,s=t.name,i=t.bindPhone;i&&(this.schema.groups[0].fields[1].props["disabled"]=!0,this.isEdit=!0),this.model={phone:i,name:s,shopId:e}}},{key:"schoolInfo",get:function(){return this.$store.state.schoolInfo}}]),e}(d["c"]);Object(l["a"])([Object(d["b"])({default:""})],m.prototype,"shopId",void 0),Object(l["a"])([Object(d["b"])({default:""})],m.prototype,"shopName",void 0),m=Object(l["a"])([Object(d["a"])({name:"addForm"})],m);var j=m,O=j,y=s("2877"),g=Object(y["a"])(O,p,v,!1,null,"70ef518e",null),k=g.exports,w=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.className="店员管理",t.businessUserList=[],t.showEditbox=!1,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"mounted",value:function(){this.getBusinessUserList()}},{key:"addUser",value:function(){this.businessUserList.length>=30?this.$createDialog({type:"alert",title:"最多添加30个店员",onConfirm:function(t){}}).show():this.showEditbox=!0}},{key:"getBusinessUserList",value:function(){var t=this;this.$store.dispatch("getBusinessUserList",{shopId:this.shopId}).then(function(e){e.success&&(t.businessUserList=e.data)})}},{key:"testSend",value:function(t){var e=this;t.qwUserId?this.$store.dispatch("sendTestMessage",{qwUserId:t.qwUserId}).then(function(t){t.success&&e.$createDialog({type:"alert",content:"消息已推送，商家未接收到请联系管理员。",onConfirm:function(t){}}).show()}):this.$createDialog({type:"alert",content:"店员绑定异常，请联系管理员处理",onConfirm:function(t){}}).show()}},{key:"addSuccess",value:function(t){this.showEditbox=!1,this.$createDialog({type:"alert",content:t,onConfirm:function(t){}}).show(),this.getBusinessUserList()}},{key:"deleteUser",value:function(t){var e=this;this.$createDialog({type:"confirm",title:"删除确认",content:"删除后店员需要重新绑定",confirmBtn:{text:"确定删除",active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:"取消",active:!1,disabled:!1,href:"javascript:;"},onConfirm:function(){e.$store.dispatch("deleteUserByPhoneOrId",{qwUserId:t.qwUserId||"",phone:t.bindPhone||"",shopId:e.shopId}).then(function(t){t.success?(e.$createDialog({type:"confirm",title:"删除成功",onConfirm:function(t){}}).show(),e.getBusinessUserList()):e.$createDialog({type:"confirm",title:t.message,onConfirm:function(t){}}).show()})}}).show()}},{key:"editUser",value:function(t){var e=this;console.log(t,"ooo"),this.showEditbox=!0,this.$nextTick(function(){e.$refs.addForm.setData(t)})}},{key:"shopId",get:function(){return this.$route.query.shopId}},{key:"shopName",get:function(){return this.$route.query.shopName}}]),e}(d["c"]);w=Object(l["a"])([Object(d["a"])({components:{page:b["a"],rightBox:h["a"],editBox:f["a"],addForm:k}})],w);var _=w,x=_,$=(s("200f"),Object(y["a"])(x,i,a,!1,null,"8d439b1c",null));e["default"]=$.exports},"51f3":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"right-box"},t._l(t.list,function(e,i){return s("div",{key:i,staticClass:"box",on:{click:function(s){return t.boxClick(e.action)}}},[e.icon?s("i",{class:["iconfont",e.icon]}):s("span",[t._v(t._s(e.text))])])}),0)},a=[],n=s("d225"),o=s("b0b4"),c=s("308d"),r=s("6bb5"),u=s("4e2b"),l=s("9ab4"),d=s("60a3"),b=function(t){function e(){return Object(n["a"])(this,e),Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"boxClick",value:function(t){this.$emit("click",t)}}]),e}(d["c"]);Object(l["a"])([Object(d["b"])()],b.prototype,"list",void 0),b=Object(l["a"])([d["a"]],b);var h=b,f=h,p=(s("b493"),s("2877")),v=Object(p["a"])(f,i,a,!1,null,"1bd23a4e",null);e["a"]=v.exports},"70dd":function(t,e,s){"use strict";var i=s("ff80"),a=s.n(i);a.a},a387:function(t,e,s){},b493:function(t,e,s){"use strict";var i=s("a387"),a=s.n(i);a.a},e835:function(t,e,s){},f4e0:function(t,e,s){},fa15:function(t,e,s){"use strict";var i=s("e835"),a=s.n(i);a.a},ff80:function(t,e,s){}}]);
//# sourceMappingURL=merchantStaff.0d297ce3.js.map