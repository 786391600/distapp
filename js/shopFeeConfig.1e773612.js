(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shopFeeConfig"],{"0741":function(e,t,a){},"07e8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cube-page",class:e.type},[a("header",{staticClass:"header"},[a("h1",[e._v(e._s(e.title))]),a("i",{directives:[{name:"show",rawName:"v-show",value:e.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:e.back}}),a("div",{staticClass:"header-edit"},[e._t("edit")],2)]),a("div",{class:{wrapper:!0,isWhite:"white"===e.type}},[a("main",{staticClass:"content"},[e._t("content",[e._v(e._s(e.content))])],2)])])},n=[],s=a("d225"),r=a("b0b4"),l=a("308d"),o=a("6bb5"),c=a("4e2b"),d=a("9ab4"),p=a("60a3"),u=function(e){function t(){return Object(s["a"])(this,t),Object(l["a"])(this,Object(o["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"back",value:function(){this.$router.go(-1)}},{key:"created",value:function(){console.log("创建page ===")}}]),t}(p["c"]);Object(d["a"])([Object(p["b"])()],u.prototype,"msg",void 0),Object(d["a"])([Object(p["b"])({default:"",required:!0})],u.prototype,"title",void 0),Object(d["a"])([Object(p["b"])({default:""})],u.prototype,"type",void 0),Object(d["a"])([Object(p["b"])({default:""})],u.prototype,"desc",void 0),Object(d["a"])([Object(p["b"])({default:""})],u.prototype,"content",void 0),Object(d["a"])([Object(p["b"])({default:!0})],u.prototype,"isBack",void 0),u=Object(d["a"])([Object(p["a"])({})],u);var f=u,v=f,b=(a("2de2"),a("2877")),y=Object(b["a"])(v,i,n,!1,null,"75d201ee",null);t["a"]=y.exports},"27e2":function(e,t,a){"use strict";var i=a("0741"),n=a.n(i);n.a},"2de2":function(e,t,a){"use strict";var i=a("4867"),n=a.n(i);n.a},"35c0":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"fade"}},[e.visible?a("div",{staticClass:"edit-box"},[e._t("default")],2):e._e()])},n=[],s=a("d225"),r=a("b0b4"),l=a("308d"),o=a("6bb5"),c=a("4e2b"),d=a("9ab4"),p=a("60a3"),u=function(e){function t(){return Object(s["a"])(this,t),Object(l["a"])(this,Object(o["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"mounted",value:function(){}},{key:"hide",value:function(){this.$emit("update:visible",!1)}}]),t}(p["c"]);Object(d["a"])([Object(p["b"])({default:!1})],u.prototype,"visible",void 0),u=Object(d["a"])([Object(p["a"])({components:{}})],u);var f=u,v=f,b=(a("fa15"),a("2877")),y=Object(b["a"])(v,i,n,!1,null,"d5ca93a2",null);t["a"]=y.exports},4867:function(e,t,a){},"51f3":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right-box"},e._l(e.list,function(t,i){return a("div",{key:i,staticClass:"box",on:{click:function(a){return e.boxClick(t.action)}}},[t.icon?a("i",{class:["iconfont",t.icon]}):a("span",[e._v(e._s(t.text))])])}),0)},n=[],s=a("d225"),r=a("b0b4"),l=a("308d"),o=a("6bb5"),c=a("4e2b"),d=a("9ab4"),p=a("60a3"),u=function(e){function t(){return Object(s["a"])(this,t),Object(l["a"])(this,Object(o["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"boxClick",value:function(e){this.$emit("click",e)}}]),t}(p["c"]);Object(d["a"])([Object(p["b"])()],u.prototype,"list",void 0),u=Object(d["a"])([p["a"]],u);var f=u,v=f,b=(a("b493"),a("2877")),y=Object(b["a"])(v,i,n,!1,null,"1bd23a4e",null);t["a"]=y.exports},a387:function(e,t,a){},b493:function(e,t,a){"use strict";var i=a("a387"),n=a.n(i);n.a},c88e:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var i=a("7618");a("3b2b"),a("a481");var n=function e(t){var a;if("object"===Object(i["a"])(t))if(null===t)a=null;else if(t instanceof Date)a=t;else if(t instanceof Array){a=[];for(var n=0,s=t.length;n<s;n++)a.push(e(t[n]))}else for(var r in a={},t)a[r]=e(t[r]);else a=t;return a}},e027:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page",{attrs:{title:e.pageTitle}},[a("div",{staticClass:"edit",attrs:{slot:"edit"},slot:"edit"}),a("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"shop-admin-box"},[a("cube-form",{ref:"editForm",attrs:{model:e.model,"immediate-validate":!1,options:e.options},on:{validate:e.validateHandler,submit:e.submitHandler,reset:e.resetHandler}},[a("cube-form-group",{attrs:{legend:"抽成设置"}},[e._l(e.fields,function(e,t){return a("cube-form-item",{key:t,attrs:{field:e}})}),"ladder"===e.model.drawmode?a("div",{staticClass:"ladder"},[e._l(e.ladder,function(t,i){return a("div",{key:e.index+i,staticClass:"ladder-box"},[a("div",[a("span",[a("cube-input",{attrs:{min:0},model:{value:t.section[0],callback:function(a){e.$set(t.section,0,a)},expression:"lItem.section[0]"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("价格-大于等于")])])],1),a("span",[a("cube-input",{attrs:{min:0},model:{value:t.section[1],callback:function(a){e.$set(t.section,1,a)},expression:"lItem.section[1]"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("小于")])])],1)]),a("div",[a("cube-radio-group",{attrs:{options:e.typeoptions,horizontal:!0},on:{input:function(a){return e.typeOptionsChange(i,t.type)}},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"lItem.type"}}),"regular"==t.type?a("div",[a("cube-input",{attrs:{min:0},model:{value:t.fee,callback:function(a){e.$set(t,"fee",a)},expression:"lItem.fee"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("抽成")])])],1):e._e(),"bytype"==t.type?a("div",[a("cube-input",{attrs:{min:0},model:{value:t.typefee.delivery,callback:function(a){e.$set(t.typefee,"delivery",a)},expression:"lItem.typefee.delivery"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("外卖")])]),a("cube-input",{attrs:{min:0},model:{value:t.typefee.selflifting,callback:function(a){e.$set(t.typefee,"selflifting",a)},expression:"lItem.typefee.selflifting"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("自取")])]),a("cube-input",{attrs:{min:0},model:{value:t.typefee.arrival,callback:function(a){e.$set(t.typefee,"arrival",a)},expression:"lItem.typefee.arrival"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("到店核销")])])],1):e._e()],1),a("span",{on:{click:function(t){return e.deleteLadder(e.index)}}},[e._v("删除")])])}),a("cube-button",{attrs:{inline:!0},on:{click:e.addLadder}},[e._v("新增阶梯")])],2):e._e(),"fixed"===e.model.drawmode?a("div",{staticClass:"ladder"},[a("cube-radio-group",{attrs:{options:e.typeoptions,horizontal:!0},on:{input:e.typeOptionsChange},model:{value:e.fixed.type,callback:function(t){e.$set(e.fixed,"type",t)},expression:"fixed.type"}}),"regular"==e.fixed.type?a("div",[a("cube-input",{attrs:{min:0},model:{value:e.fixed.value,callback:function(t){e.$set(e.fixed,"value",t)},expression:"fixed.value"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("抽成")])])],1):e._e(),"bytype"==e.fixed.type?a("div",[a("cube-input",{attrs:{min:0},model:{value:e.fixed.typeValue.delivery,callback:function(t){e.$set(e.fixed.typeValue,"delivery",t)},expression:"fixed.typeValue.delivery"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("外卖")])]),a("cube-input",{attrs:{min:0},model:{value:e.fixed.typeValue.selflifting,callback:function(t){e.$set(e.fixed.typeValue,"selflifting",t)},expression:"fixed.typeValue.selflifting"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("自取")])]),a("cube-input",{attrs:{min:0},model:{value:e.fixed.typeValue.arrival,callback:function(t){e.$set(e.fixed.typeValue,"arrival",t)},expression:"fixed.typeValue.arrival"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("到店核销")])])],1):e._e()],1):e._e(),"percentage"===e.model.drawmode?a("div",{staticClass:"ladder"},[a("cube-radio-group",{attrs:{options:e.typeoptions,horizontal:!0},on:{input:e.typeOptionsChange},model:{value:e.percentage.type,callback:function(t){e.$set(e.percentage,"type",t)},expression:"percentage.type"}}),"regular"==e.percentage.type?a("div",[a("cube-input",{attrs:{min:0,max:100},model:{value:e.percentage.value,callback:function(t){e.$set(e.percentage,"value",t)},expression:"percentage.value"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("抽成")]),a("div",{attrs:{slot:"append"},slot:"append"},[e._v("%")])])],1):e._e(),"bytype"==e.percentage.type?a("div",[a("cube-input",{attrs:{min:0,max:100},model:{value:e.percentage.typeValue.delivery,callback:function(t){e.$set(e.percentage.typeValue,"delivery",t)},expression:"percentage.typeValue.delivery"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("外卖")]),a("div",{attrs:{slot:"append"},slot:"append"},[e._v("%")])]),a("cube-input",{attrs:{min:0,max:100},model:{value:e.percentage.typeValue.selflifting,callback:function(t){e.$set(e.percentage.typeValue,"selflifting",t)},expression:"percentage.typeValue.selflifting"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("自取")]),a("div",{attrs:{slot:"append"},slot:"append"},[e._v("%")])]),a("cube-input",{attrs:{min:0,max:100},model:{value:e.percentage.typeValue.arrival,callback:function(t){e.$set(e.percentage.typeValue,"arrival",t)},expression:"percentage.typeValue.arrival"}},[a("div",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("到店核销")]),a("div",{attrs:{slot:"append"},slot:"append"},[e._v("%")])])],1):e._e()],1):e._e(),e._l(e.savefields,function(e,t){return a("cube-form-item",{key:t,attrs:{field:e}})})],2)],1)],1)])])},n=[],s=a("7618"),r=(a("c5f6"),a("d263"),a("d225")),l=a("b0b4"),o=a("308d"),c=a("6bb5"),d=a("4e2b"),p=a("9ab4"),u=a("60a3"),f=a("07e8"),v=a("51f3"),b=a("35c0"),y=a("c88e"),h=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.showEditbox=!1,e.showAddNav=!1,e.pageTitle="抽成设置",e.typeoptions=[{label:"固定",value:"regular"},{label:"按类型",value:"bytype"}],e.data=[],e.currentIndex=0,e.modelIndex=0,e.headImgList=[],e.model={drawmode:"ladder"},e.imageList=[],e.isEdit=!1,e.fields=[{type:"radio-group",label:"抽成方式",modelKey:"drawmode",props:{options:[{label:"阶梯收费",value:"ladder"},{label:"固定收费",value:"fixed"},{label:"百分比",value:"percentage"}]},rules:{required:!0},messages:{required:"必须选择一种抽成方式"}}],e.ladder=[],e.fixed={type:"",value:0,typeValue:{delivery:0,selflifting:0,arrival:0}},e.percentage={type:"",value:0,typeValue:{delivery:0,selflifting:0,arrival:0}},e.bisection={number:0,fee:0},e.savefields=[{type:"submit",label:"保存"}],e.options={scrollToInvalidField:!0,layout:"classic"},e}return Object(d["a"])(t,e),Object(l["a"])(t,[{key:"typeOptionsChange",value:function(e,t){"ladder"===this.model.drawmode?"bytype"===this[this.model.drawmode][e].type&&(this[this.model.drawmode][e].typefee||(this[this.model.drawmode][e].typefee={delivery:0,selflifting:0,arrival:0})):"bytype"===this[this.model.drawmode].type&&(this[this.model.drawmode].typeValue||(this[this.model.drawmode].typeValue={delivery:0,selflifting:0,arrival:0}))}},{key:"created",value:function(){var e=Object(y["a"])(this.$route.params);this.pageTitle=e.title,this.initConfig(e),this.headImgList=[e.headImg]}},{key:"addLadder",value:function(){this.ladder.push({section:[0,0],fee:0,type:"regular"})}},{key:"resetHandler",value:function(){this.$emit("cancel")}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault();var a=this.model.drawmode,i={type:a,value:null};if("ladder"===a){var n=this.ladderValidate();if(!n)return}else if("fixed"===a){if(this.fixed.value=Number(this.fixed.value),0>this.fixed.value||isNaN(this.fixed.value)){var r=this.$createToast({txt:"固定值需大于等于0",type:"error"});return void r.show()}}else if("percentage"===a){if(this.percentage.value=Number(this.percentage.value),console.log(Object(s["a"])(this.percentage.value),"this.percentage.valueppp"),0>this.percentage.value||this.percentage.value>100||isNaN(this.percentage.value)){var l=this.$createToast({txt:"百分值需大于等于0小于等于100",type:"error"});return void l.show()}}else if("bisection"===a){if(this.bisection.number<=0){var o=this.$createToast({txt:"等分值需大于0",type:"error"});return void o.show()}if(this.bisection.fee=Number(this.bisection.fee),0>this.bisection.fee||isNaN(this.bisection.fee)){var c=this.$createToast({txt:"等分抽成需大于等于0",type:"error"});return void c.show()}}i.value=this[a];var d={dfConfig:i};this.$store.dispatch("updateShopInfoByObj",{shopId:this.shopId,value:{dfConfig:i}}).then(function(e){e.success&&t.$createDialog({type:"alert",content:"保存成功",onConfirm:function(e){t.$router.push({name:"businessManagement",params:{id:t.shopId,oprate:"update",data:d}})}}).show()})}},{key:"ladderValidate",value:function(){var e=this;this.ladder=this.ladder.map(function(e){return{section:[isNaN(Number(e.section[0]))?0:Number(e.section[0]),isNaN(Number(e.section[1]))?0:Number(e.section[1])],fee:isNaN(Number(e.fee))?0:Number(e.fee),type:e.type||"",typefee:e.typefee}});var t=!0;if(this.ladder.length<=0){t=!1;var a=this.$createToast({txt:"请设置阶梯",type:"error"});a.show()}else{var i;this.ladder.some(function(a){if(i){if(a.section[0]!==i[1]){t=!1;var n=e.$createToast({txt:"后一阶梯最小值需等于前一个阶梯最大值",type:"error"});return n.show(),!0}i=a.section}else if(i=a.section,0!==i[0]){t=!1;var s=e.$createToast({txt:"阶梯收费需要从0开始",type:"error"});return s.show(),!0}if(i[1]<=i[0]){t=!1;var r=e.$createToast({txt:"阶梯收费结束费用需大于起始费用",type:"error"});return r.show(),!0}})}return t}},{key:"showToastType",value:function(){var e=this.$createToast({txt:"保存成功",type:"correct"});e.show()}},{key:"deleteLadder",value:function(e){this.ladder.splice(e,1)}},{key:"initConfig",value:function(e){var t="";e&&e.dfConfig?(t=e.dfConfig.type,this[t]=e.dfConfig.value):t="ladder",this.model={drawmode:t}}},{key:"shopId",get:function(){return this.$route.params.id}},{key:"shopName",get:function(){return this.$route.query.shopName}},{key:"schoolInfo",get:function(){return this.$store.state.schoolInfo}}]),t}(u["c"]);h=Object(p["a"])([Object(u["a"])({components:{page:f["a"],rightBox:v["a"],editBox:b["a"]}})],h);var m=h,g=m,x=(a("27e2"),a("2877")),O=Object(x["a"])(g,i,n,!1,null,null,null);t["default"]=O.exports},e835:function(e,t,a){},fa15:function(e,t,a){"use strict";var i=a("e835"),n=a.n(i);n.a}}]);
//# sourceMappingURL=shopFeeConfig.1e773612.js.map