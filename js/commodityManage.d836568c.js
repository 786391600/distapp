(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["commodityManage"],{"07e8":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cube-page",class:t.type},[i("header",{staticClass:"header"},[i("h1",[t._v(t._s(t.title))]),i("i",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:t.back}}),i("div",{staticClass:"header-edit"},[t._t("edit")],2)]),i("div",{class:{wrapper:!0,isWhite:"white"===t.type}},[i("section",{directives:[{name:"show",rawName:"v-show",value:t.desc,expression:"desc"}],staticClass:"desc"},[t._t("desc",[t._v(t._s(t.desc))])],2),i("main",{staticClass:"content"},[t._t("content",[t._v(t._s(t.content))])],2)])])},a=[],o=i("d225"),c=i("b0b4"),n=i("308d"),r=i("6bb5"),l=i("4e2b"),d=i("9ab4"),u=i("60a3"),b=function(t){function e(){return Object(o["a"])(this,e),Object(n["a"])(this,Object(r["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"back",value:function(){this.$router.back()}}]),e}(u["c"]);Object(d["a"])([Object(u["b"])()],b.prototype,"msg",void 0),Object(d["a"])([Object(u["b"])({default:"",required:!0})],b.prototype,"title",void 0),Object(d["a"])([Object(u["b"])({default:""})],b.prototype,"type",void 0),Object(d["a"])([Object(u["b"])({default:""})],b.prototype,"desc",void 0),Object(d["a"])([Object(u["b"])({default:""})],b.prototype,"content",void 0),Object(d["a"])([Object(u["b"])({default:!0})],b.prototype,"isBack",void 0),b=Object(d["a"])([u["a"]],b);var p=b,m=p,f=(i("89d1"),i("2877")),h=Object(f["a"])(m,s,a,!1,null,"cbeccb54",null);e["a"]=h.exports},"0ba3":function(t,e,i){},"286a":function(t,e,i){},3896:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page",{attrs:{title:"商店管理",type:"white"}},[i("div",{attrs:{slot:"edit"},slot:"edit"},[i("span",{staticClass:"add-btn",on:{click:t.addShop}},[t._v("新增商店")])]),i("div",{attrs:{slot:"content"},slot:"content"},[i("ul",{staticClass:"commodity-list"},t._l(t.shopList,function(e,s){return i("li",{key:s,staticClass:"commodity-card"},[i("div",{staticClass:"shop-info"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.imgUrlList.length>0,expression:"item.imgUrlList.length > 0"}],staticClass:"shop-img"},[i("img",{attrs:{src:e.imgUrlList[0]}})]),i("div",{staticClass:"shop-info"},[i("p",{staticClass:"title"},[t._v(t._s(e.name))])])]),i("div",{staticClass:"edit"},[i("cube-button",{staticClass:"btn",attrs:{inline:!0},on:{click:function(i){return t.editShop(e)}}},[t._v("店铺编辑")]),i("cube-button",{staticClass:"btn",attrs:{primary:!0,inline:!0},on:{click:function(i){return t.toCommodityClass(e)}}},[t._v("商品管理")])],1)])}),0),i("div",{directives:[{name:"show",rawName:"v-show",value:t.shopList.length<=0,expression:"shopList.length <= 0"}],staticClass:"empy"},[t._v("暂无数据")]),t.showAdd?i("shopAdd",{staticClass:"commodity-add-box",attrs:{data:t.shopObj,classId:t.classId},on:{cancel:t.addCancel,saveSuccess:t.saveSuccess}}):t._e()],1)])},a=[],o=i("d225"),c=i("b0b4"),n=i("308d"),r=i("6bb5"),l=i("4e2b"),d=i("9ab4"),u=i("60a3"),b=i("07e8"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("cube-form",{attrs:{model:t.model,"immediate-validate":!1,options:t.options},on:{validate:t.validateHandler,submit:t.submitHandler,reset:t.resetHandler}},[i("cube-form-group",{attrs:{legend:"商店管理"}},[i("cube-form-item",{attrs:{field:t.fields[0]}}),i("cube-form-item",{attrs:{field:t.fields[1]}}),i("imageUpload",{model:{value:t.model.imgUrlList,callback:function(e){t.$set(t.model,"imgUrlList",e)},expression:"model.imgUrlList"}})],1),i("cube-form-group",[i("cube-button",{staticClass:"button",attrs:{type:"reset",inline:!0}},[t._v("取消")]),i("cube-button",{staticClass:"button",attrs:{type:"submit",inline:!0,primary:!0}},[t._v("保存")])],1)],1)],1)},m=[],f=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),h=i("5102"),v=i("7618");i("3b2b"),i("a481");function y(t){if(!t&&"object"!==Object(v["a"])(t))throw new Error("error arguments","deepClone");var e=t.constructor===Array?[]:{};return Object.keys(t).forEach(function(i){t[i]&&"object"===Object(v["a"])(t[i])?e[i]=y(t[i]):e[i]=t[i]}),e}function O(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function g(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?O(i,!0).forEach(function(e){Object(f["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):O(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var j=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(n["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.model={name:"",distribution:!1,imgUrlList:[]},t.fields=[{type:"input",modelKey:"name",label:"商店名称",props:{placeholder:"请输入"},rules:{required:!0},trigger:"blur"},{type:"switch",modelKey:"distribution",label:"是否配送"}],t.options={scrollToInvalidField:!0,layout:"standard"},t}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"created",value:function(){this.data.id&&(this.model=y(this.data))}},{key:"validateHandler",value:function(){console.log("ddd")}},{key:"submitHandler",value:function(t){var e=this;t.preventDefault();var i,s=this.$store.state.userInfo.business;i=g({},this.model,{businessId:s}),this.$store.dispatch("addOrUpdateShop",i).then(function(t){if(t.success){t.data?e.$emit("saveSuccess","add",t.data):e.$emit("saveSuccess","update",i);var s=e.$createToast({txt:"保存成功",time:3e3,type:"txt"});s.show()}})}},{key:"resetHandler",value:function(){this.$emit("cancel")}}]),e}(u["c"]);Object(d["a"])([Object(u["b"])({default:""})],j.prototype,"classId",void 0),Object(d["a"])([Object(u["b"])({default:{name:"",distribution:!1,imgUrlList:[]}})],j.prototype,"data",void 0),j=Object(d["a"])([Object(u["a"])({components:{page:b["a"],imageUpload:h["a"]}})],j);var w=j,C=w,k=(i("3955"),i("2877")),_=Object(k["a"])(C,p,m,!1,null,"75cf5e36",null),$=_.exports,I=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(n["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.classId="",t.className="",t.shopList=[],t.showAdd=!1,t.shopObj={name:"",distribution:!1,imgUrlList:[]},t}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"getShopList",value:function(){var t=this,e=this.$store.state.userInfo.business,i=this["$createToast"]({time:0,txt:"商店获取中..."});i.show(),this.$store.dispatch("getShopList",{page:1,businessId:e}).then(function(e){if(e.success){var s=e.data.list;t.$set(t,"shopList",s),i.hide()}})}},{key:"addShop",value:function(){this.shopObj={name:"",distribution:!1,imgUrlList:[]},this.showAdd=!0}},{key:"addCancel",value:function(){this.showAdd=!1}},{key:"saveSuccess",value:function(t,e){var i;"add"===t?this.shopList.push(e):(this.shopList.some(function(t,s){if(e.id===t.id)return i=s,!0}),this.$set(this.shopList,i,e));this.addCancel()}},{key:"editShop",value:function(t){this.shopObj=t,this.showAdd=!0}},{key:"mounted",value:function(){this.getShopList()}},{key:"toCommodityClass",value:function(t){this.$router.push({path:"/commodityManageClass",query:{shopId:t.id}})}}]),e}(u["c"]);I=Object(d["a"])([Object(u["a"])({components:{page:b["a"],shopAdd:$}})],I);var L=I,x=L,A=(i("55b5"),Object(k["a"])(x,s,a,!1,null,"1c587d97",null));e["default"]=A.exports},3955:function(t,e,i){"use strict";var s=i("0ba3"),a=i.n(s);a.a},"3a85":function(t,e,i){},5102:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"file-upload"},[i("div",{staticClass:"file-upload-box"},[t._l(t.imageArr,function(e,s){return i("div",{key:e,staticClass:"img-box"},[i("img",{staticClass:"imgPriview",attrs:{src:e},on:{click:function(e){return t.handleImgsClick(s)}}}),i("i",{staticClass:"cubeic-wrong",on:{click:function(i){return t.imageRemove(e,s)}}})])}),i("cube-upload",{ref:"upload",attrs:{action:t.action,"simultaneous-uploads":1},on:{"files-added":t.filesAdded,"file-removed":t.fileRemove,"file-success":t.fileSuccess},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[i("div",{staticClass:"clear-fix"},[i("cube-upload-btn",{attrs:{multiple:!1}},[i("div",{staticClass:"cube-upload-btn-def"},[i("i")])])],1)])],2)])},a=[],o=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),c=i("d225"),n=i("b0b4"),r=i("308d"),l=i("6bb5"),d=i("4e2b"),u=i("9ab4"),b=i("60a3");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(i,!0).forEach(function(e){Object(o["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var f=function(t){function e(){var t;return Object(c["a"])(this,e),t=Object(r["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.fileUrl="http://img.beijixiong.club:4869/",t.imageArr=[],t.action={target:"/fileUpload",data:{token:"rwwXO0wQq5SBEqP7"}},t.isUploading=!0,t}return Object(d["a"])(e,t),Object(n["a"])(e,[{key:"upload",value:function(){this.isUploading=!0,this.$refs.upload.start()}},{key:"pause",value:function(){this.isUploading=!1,this.$refs.upload.pause()}},{key:"retry",value:function(){this.$refs.upload.retry()}},{key:"filesAdded",value:function(t){var e=!1,i=1048576;for(var s in t){var a=t[s];a.size>i&&(a.ignore=!0,e=!0)}e&&this.$createToast({type:"warn",time:2e3,txt:"文件需要小于1M"}).show()}},{key:"fileRemove",value:function(t){if(t.response&&t.response.md5){var e=this.fileUrl+t.response.md5,i=this.imageArr.indexOf(e);i>-1&&this.imageArr.splice(i,1)}}},{key:"fileSuccess",value:function(t){var e=t.response.md5,i=this.fileUrl+e,s=this.imageArr.indexOf(i);-1===s&&this.imageArr.push(i)}},{key:"handleImgsClick",value:function(t){var e=this;this.initialIndex=t;var i={$props:{imgs:this.imageArr,initialIndex:"initialIndex",loop:!1},$events:{change:function(t){e.initialIndex=t}}};this.$createImagePreview(m({},i)).show()}},{key:"imageArrChange",value:function(t){this.$emit("input",t)}},{key:"valueChange",value:function(t){this.$set(this,"imageArr",t)}},{key:"imageRemove",value:function(t,e){var i=this;this.$store.dispatch("removeImage",{url:t}).then(function(s){s.success&&(console.log(t),console.log("图片删除成功！")),i.imageArr.splice(e,1)})}}]),e}(b["c"]);Object(u["a"])([Object(b["b"])({default:[]})],f.prototype,"value",void 0),Object(u["a"])([Object(b["d"])("imageArr")],f.prototype,"imageArrChange",null),Object(u["a"])([Object(b["d"])("value",{immediate:!0})],f.prototype,"valueChange",null),f=Object(u["a"])([Object(b["a"])({components:{},filters:{}})],f);var h=f,v=h,y=(i("753f"),i("2877")),O=Object(y["a"])(v,s,a,!1,null,null,null);e["a"]=O.exports},"55b5":function(t,e,i){"use strict";var s=i("3a85"),a=i.n(s);a.a},"753f":function(t,e,i){"use strict";var s=i("7952"),a=i.n(s);a.a},7952:function(t,e,i){},"7b0f":function(t,e,i){"use strict";var s=i("a5af"),a=i.n(s);a.a},"89d1":function(t,e,i){"use strict";var s=i("f242"),a=i.n(s);a.a},a5af:function(t,e,i){},c51b:function(t,e,i){"use strict";var s=i("286a"),a=i.n(s);a.a},d6c5:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page",{attrs:{title:t.className,type:"white"}},[i("div",{attrs:{slot:"edit"},slot:"edit"},[i("span",{staticClass:"add-btn",on:{click:t.addCommodity}},[t._v("新增商品")])]),i("div",{attrs:{slot:"content"},slot:"content"},[i("ul",{staticClass:"commodity-list"},t._l(t.commodityList,function(e,s){return i("li",{key:s,staticClass:"commodity-card"},[i("div",[i("p",{staticClass:"title"},[t._v(t._s(e.name))]),i("p",{staticClass:"price"},[t._v("价格："+t._s(e.price)+"元")]),i("p",{staticClass:"price"},[t._v("单位："+t._s(e.unit))]),i("p",{staticClass:"class"},[t._v("分类："+t._s(t.className))])]),i("div",{staticClass:"edit"},[i("cube-button",{attrs:{inline:!0},on:{click:function(i){return t.editCommodity(e)}}},[t._v("编辑")])],1)])}),0),i("div",{directives:[{name:"show",rawName:"v-show",value:t.commodityList.length<=0,expression:"commodityList.length <= 0"}],staticClass:"empy"},[t._v("暂无数据")]),t.showAdd?i("commodityAdd",{staticClass:"commodity-add-box",attrs:{data:t.commodityObj,classId:t.classId,shopId:t.shopId},on:{cancel:t.addCancel,saveSuccess:t.saveSuccess}}):t._e()],1)])},a=[],o=i("d225"),c=i("b0b4"),n=i("308d"),r=i("6bb5"),l=i("4e2b"),d=i("9ab4"),u=i("60a3"),b=i("07e8"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("cube-form",{attrs:{model:t.model,"immediate-validate":!1,options:t.options},on:{validate:t.validateHandler,submit:t.submitHandler,reset:t.resetHandler}},[i("cube-form-group",{attrs:{legend:"商品添加"}},[i("cube-form-item",{attrs:{field:t.fields[0]}}),i("cube-form-item",{attrs:{field:t.fields[1]}}),i("cube-form-item",{attrs:{field:t.fields[2]}}),i("cube-form-item",{attrs:{field:t.fields[3]}}),i("cube-form-item",{attrs:{field:t.fields[4]}}),i("imageUpload",{model:{value:t.model.imgUrlList,callback:function(e){t.$set(t.model,"imgUrlList",e)},expression:"model.imgUrlList"}})],1),i("cube-form-group",[i("cube-button",{staticClass:"button",attrs:{type:"reset",inline:!0}},[t._v("取消")]),i("cube-button",{staticClass:"button",attrs:{type:"submit",inline:!0,primary:!0}},[t._v("保存")])],1)],1)],1)},m=[],f=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),h=i("5102");function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(i,!0).forEach(function(e){Object(f["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var O=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(n["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.model={name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]},t.fields=[{type:"input",modelKey:"name",label:"商品名称",props:{placeholder:"请输入"},rules:{required:!0},trigger:"blur"},{type:"input",modelKey:"price",label:"价格",props:{placeholder:"请输入价格"},rules:{required:!0,type:"number"},trigger:"blur"},{type:"select",modelKey:"unit",label:"单位",props:{options:["个","斤","件","箱","平米","条"]},rules:{required:!0}},{type:"switch",modelKey:"disabled",label:"是否上架"},{type:"input",modelKey:"number",label:"数量",props:{placeholder:"请输入数量"},rules:{type:"number",required:!0},trigger:"blur"}],t.options={scrollToInvalidField:!0,layout:"standard"},t}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"created",value:function(){this.data.id&&(this.model=this.data)}},{key:"validateHandler",value:function(){console.log("ddd")}},{key:"submitHandler",value:function(t){var e=this;t.preventDefault();var i,s=this.$store.state.userInfo.business;i=y({},this.model,{businessId:s,class:this.classId,shopId:this.shopId}),console.log(i,"iiiiiiiiiiiiiiiiiiiiiiii"),this.$store.dispatch("addOrUpdateCommodity",i).then(function(t){if(t.success){t.data?e.$emit("saveSuccess","add",t.data):e.$emit("saveSuccess","update",i);var s=e.$createToast({txt:"保存成功",time:3e3,type:"txt"});s.show()}})}},{key:"resetHandler",value:function(){this.$emit("cancel")}}]),e}(u["c"]);Object(d["a"])([Object(u["b"])({default:""})],O.prototype,"classId",void 0),Object(d["a"])([Object(u["b"])({default:""})],O.prototype,"shopId",void 0),Object(d["a"])([Object(u["b"])({default:{name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]}})],O.prototype,"data",void 0),O=Object(d["a"])([Object(u["a"])({components:{page:b["a"],imageUpload:h["a"]}})],O);var g=O,j=g,w=(i("c51b"),i("2877")),C=Object(w["a"])(j,p,m,!1,null,"1a973f70",null),k=C.exports,_=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(n["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.classId="",t.className="",t.shopId="",t.commodityList=[],t.showAdd=!1,t.commodityObj={name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]},t}return Object(l["a"])(e,t),Object(c["a"])(e,[{key:"activated",value:function(){var t=this.$route.query;this.classId=t.id,this.shopId=t.shopId,this.className=t.name,this.showAdd=!1}},{key:"deactivated",value:function(){this.classId="",this.$set(this,"commodityList",[])}},{key:"idChange",value:function(t){t&&this.getCommodityListByClassId()}},{key:"getCommodityListByClassId",value:function(){var t=this;if(this.classId){var e=this["$createToast"]({time:0,txt:"商品获取中..."});e.show(),this.$store.dispatch("getCommodityListByClassId",{class:this.classId,page:1}).then(function(i){if(i.success){var s=i.data.list;t.$set(t,"commodityList",s),e.hide()}})}}},{key:"addCommodity",value:function(){this.commodityObj={name:"",price:0,unit:"",disabled:!1,number:0,imgUrlList:[]},this.showAdd=!0}},{key:"addCancel",value:function(){this.showAdd=!1}},{key:"saveSuccess",value:function(t,e){var i;"add"===t?this.commodityList.push(e):(this.commodityList.some(function(t,i){if(e.id===t.id)return i=i,!0}),this.$set(this.commodityList,i,e));this.addCancel()}},{key:"editCommodity",value:function(t){this.commodityObj=t,this.showAdd=!0}},{key:"mounted",value:function(){}}]),e}(u["c"]);Object(d["a"])([Object(u["d"])("classId")],_.prototype,"idChange",null),_=Object(d["a"])([Object(u["a"])({components:{page:b["a"],commodityAdd:k}})],_);var $=_,I=$,L=(i("7b0f"),Object(w["a"])(I,s,a,!1,null,"6cb97e12",null));e["default"]=L.exports},f242:function(t,e,i){}}]);
//# sourceMappingURL=commodityManage.d836568c.js.map