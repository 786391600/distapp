(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["index"],{"9ed6":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[e._m(0),i("cube-form",{staticClass:"home-form",attrs:{model:e.model,options:e.options},on:{validate:e.validateHandler,submit:e.submitHandler}},[i("cube-form-group",[i("div",[i("cube-form-item",{attrs:{field:e.fields[0]}})],1),e.isVerification?i("div",{staticClass:"verificationCode"},[i("div",[i("cube-form-item",{attrs:{field:e.fields[1]}})],1),i("div",{staticClass:"verificationCode-button"},[i("cube-button",{attrs:{outline:!0,primary:!0,inline:!0},on:{click:e.getVerificationCode}},[e.sendMsgDisabled?i("span",[e._v(e._s(e.time+"秒后获取"))]):i("span",[e._v("获取验证码")])])],1)]):e._e()]),i("cube-form-group",[i("cube-button",{staticClass:"submit",attrs:{type:"submit"}},[e._v("立即绑定")])],1)],1)],1)},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"header"},[i("span",{staticClass:"title"},[e._v("请输入手机号")]),i("span",{staticClass:"tip"},[e._v("请输入您在小区物业绑定的手机号")])])}],n=(i("a481"),i("d225")),s=i("b0b4"),r=i("308d"),c=i("6bb5"),d=i("4e2b"),l=i("9ab4"),u=i("60a3"),p=i("fdab"),h=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.model={phone:"",openid:""},e.fields=[{type:"input",modelKey:"phone",label:"手机号",props:{placeholder:"请输入号码"},rules:{required:!0,type:"tel"}},{type:"input",modelKey:"verificationCode",label:"验证码",props:{placeholder:"请输入",type:"text"},rules:{required:!0}}],e.valid=void 0,e.validity={},e.options={},e.time=60,e.sendMsgDisabled=!1,e.isVerification=!1,e.openid="",e.jump="",e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"mounted",value:function(){this.openid=this.$route.query.openid,this.jump=this.$route.query.jump}},{key:"onRouterChanged",value:function(){console.log("路由编号")}},{key:"validateHandler",value:function(e){this.validity=e.validity,this.valid=e.valid,console.log(e),console.log("validity",e.validity,e.valid,e.dirty,e.firstInvalidFieldIndex)}},{key:"submitHandler",value:function(e){var t=this;if(e.preventDefault(),this.openid){var i=this["$createToast"]({time:0,txt:"绑定中..."});i.show();var o=Object.assign({},this.model);o.openid=this.openid,this.$store.dispatch("bindingOpenid",o).then(function(e){if(i.hide(),e.success){var o=e.data;o.sendSms?(t.isVerification=!0,t.startCountdown()):o.isBind?(t.$store.commit("SET_SESSION_ID",t.openid),t.$router.replace({path:t.jump})):t["$createDialog"]({type:"alert",content:"您的手机号没有绑定房屋，请联系您所在小区物业绑定手机！",icon:"cubeic-wrong"}).show()}else"verificationCode"===e.type&&t["$createDialog"]({type:"alert",content:"验证码错误或者过期",icon:"cubeic-wrong"}).show()})}else{var a=this["$createToast"]({time:1e3,txt:"稍后再试..."});a.show()}}},{key:"getVerificationCode",value:function(e){var t=this;if(e.preventDefault(),!this.sendMsgDisabled)if(this.openid){var i=this["$createToast"]({time:0,txt:"绑定中..."});i.show();var o=Object.assign({},this.model);o.openid=this.openid,this.$store.dispatch("bindingOpenid",o).then(function(e){if(i.hide(),e.success){var o=e.data;o.sendSms?(t.isVerification=!0,t.startCountdown()):o.isBind?(t.$store.commit("SET_SESSION_ID",t.openid),t.$router.replace({path:t.jump})):t["$createDialog"]({type:"alert",content:"您的手机号没有绑定房屋，请联系您所在小区物业绑定手机！",icon:"cubeic-wrong"}).show()}else"verificationCode"===e.type&&t["$createDialog"]({type:"alert",content:"验证码错误或者过期",icon:"cubeic-wrong"}).show()})}else{var a=this["$createToast"]({time:1e3,txt:"稍后再试..."});a.show()}}},{key:"submitClick",value:function(){return!1}},{key:"startCountdown",value:function(){var e=this;if(e.sendMsgDisabled)return!1;e.sendMsgDisabled=!0;var t=window.setInterval(function(){(!e.isVerification||e.time--<=0)&&(e.time=60,e.sendMsgDisabled=!1,window.clearInterval(t))},1e3)}},{key:"getBindingInfo",value:function(){var e=this,t=this.$route.query;if(t.code){var i=this["$createToast"]({time:0,txt:"数据获取中..."});i.show(),this.$store.dispatch("getCodeInfo",{code:t.code}).then(function(t){t.success&&(t.data.openid?e.openid=t.data.openid:t.data.sessionId&&(e.$store.commit("SET_SESSION_ID",t.data.sessionId),e.$store.commit("SET_USER_INFO",t.data.userInfo),e.$router.replace({path:"/home"}))),i.hide()})}else console.log("不是微信登陆")}},{key:"phoneChange",value:function(){this.isVerification&&(this.isVerification=!1,this.time=60)}},{key:"computedMsg",get:function(){return"computed "+this.propB}}]),t}(u["c"]);Object(l["a"])([Object(u["b"])({default:"default value"})],h.prototype,"propB",void 0),Object(l["a"])([Object(u["d"])("$route")],h.prototype,"onRouterChanged",null),Object(l["a"])([Object(u["d"])("model.phone")],h.prototype,"phoneChange",null),h=Object(l["a"])([Object(u["a"])({components:{HelloWorld:p["a"]}})],h);var f=h,v=f,b=(i("e9af"),i("b9ac"),i("2877")),m=Object(b["a"])(v,o,a,!1,null,"bfaa64c4",null);t["default"]=m.exports},b9ac:function(e,t,i){"use strict";var o=i("c8a6"),a=i.n(o);a.a},c8a6:function(e,t,i){},e752:function(e,t,i){},e9af:function(e,t,i){"use strict";var o=i("e752"),a=i.n(o);a.a}}]);
//# sourceMappingURL=index.2d39bdcf.js.map