(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fleetTaskInfo"],{"07e8":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cube-page",class:t.type},[a("header",{staticClass:"header"},[a("h1",[t._v(t._s(t.title))]),a("i",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:t.back}}),a("div",{staticClass:"header-edit"},[t._t("edit")],2)]),a("div",{class:{wrapper:!0,isWhite:"white"===t.type}},[a("section",{directives:[{name:"show",rawName:"v-show",value:t.desc,expression:"desc"}],staticClass:"desc"},[t._t("desc",[t._v(t._s(t.desc))])],2),a("main",{staticClass:"content"},[t._t("content",[t._v(t._s(t.content))])],2)])])},s=[],n=a("d225"),o=a("b0b4"),c=a("308d"),r=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),v=function(t){function e(){return Object(n["a"])(this,e),Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"back",value:function(){this.$router.back()}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])()],v.prototype,"msg",void 0),Object(u["a"])([Object(d["b"])({default:"",required:!0})],v.prototype,"title",void 0),Object(u["a"])([Object(d["b"])({default:""})],v.prototype,"type",void 0),Object(u["a"])([Object(d["b"])({default:""})],v.prototype,"desc",void 0),Object(u["a"])([Object(d["b"])({default:""})],v.prototype,"content",void 0),Object(u["a"])([Object(d["b"])({default:!0})],v.prototype,"isBack",void 0),v=Object(u["a"])([d["a"]],v);var h=v,f=h,p=(a("ca73"),a("2877")),b=Object(p["a"])(f,i,s,!1,null,"0717ebb4",null);e["a"]=b.exports},"0c27":function(t,e,a){},"10f0":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav-box"},[a("div",{staticClass:"nav-scroll"},[a("div",{staticClass:"item-box"},t._l(t.list,function(e,i){return a("div",{key:i,class:{box:!0,active:t.currentValue===e.value},on:{click:function(a){return t.setValue(e.value)}}},[t._v(t._s(e.label))])}),0)])])},s=[],n=a("d225"),o=a("b0b4"),c=a("308d"),r=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),v=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.currentValue="",t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){console.log("navvvvvvvvvvvvvvvvvvvvvvvvvvvvv"),this.currentValue=this.list[0].value,this.emitValue(this.list[0].value)}},{key:"setValue",value:function(t){this.currentValue=t,this.emitValue(t)}},{key:"emitValue",value:function(t){this.$emit("change",t)}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])()],v.prototype,"list",void 0),v=Object(u["a"])([Object(d["a"])({components:{}})],v);var h=v,f=h,p=(a("1266"),a("2877")),b=Object(p["a"])(f,i,s,!1,null,null,null);e["a"]=b.exports},1266:function(t,e,a){"use strict";var i=a("0c27"),s=a.n(i);s.a},"17c8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{attrs:{type:"form-def",title:t.title,isBack:!0}},[a("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"list"},t._l(t.dataList,function(e,i){return a("div",{key:i,staticClass:"list-item"},[a("div",{staticClass:"list-item-title"},[t._v("发车日期: "+t._s(t.getFormatTime(e.departureTime)))]),a("div",{staticClass:"list-item-content"},[a("p",[t._v("当前订票： "+t._s(e.formalNum||0)+"张")]),a("p",[t._v("余票： "+t._s(e.poll||0)+"张")]),a("p",[t._v("候补： "+t._s(e.alternateNum||0)+"张")])]),a("div",{staticClass:"oprate"},[a("div",{staticClass:"btn",on:{click:function(a){return t.addOprate(e.departureTime)}}},[t._v("\r\n                 加票\r\n              ")]),a("div",{staticClass:"btn",on:{click:function(a){return t.showInfo(e)}}},[t._v("\r\n                 订单列表\r\n              ")]),a("div",{staticClass:"btn",on:{click:function(a){return t.addCar(e)}}},[t._v("\r\n                 添加车牌\r\n              ")]),a("div",{staticClass:"btn",on:{click:function(a){return t.sendNotify(e)}}},[t._v("\r\n                 发送通知\r\n              ")]),a("div",{staticClass:"btn",on:{click:t.refresh}},[t._v("\r\n                 刷新\r\n              ")])])])}),0),a("pageView")],1)])},s=[],n=(a("456d"),a("ac6a"),a("c5f6"),a("d225")),o=a("b0b4"),c=a("308d"),r=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),v=a("07e8"),h=a("3a45"),f=a("10f0"),p=function(t){function e(){var t;return Object(n["a"])(this,e),t=Object(c["a"])(this,Object(r["a"])(e).apply(this,arguments)),t.point={},t.showMore=!0,t.currentTab="",t.dataList=[],t.departureTimeList=[],t.timeRows=[],t.dialog=null,t}return Object(l["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){this.fleetId=this.$route.params.fleetId,this.departureTimeList=this.$route.params.departureTimeList,this.title="订票详情",this.getTaskInfo(this.fleetId,this.departureTimeList)}},{key:"getTaskInfo",value:function(t,e){var a=this;console.log(e);var i=this["$createToast"]({time:0,txt:"加载..."});i.show(),this.$store.dispatch("getTaskInfo",{fleetId:t,departureTimeList:e}).then(function(t){if(console.log(t),t.success){var e=t.data;a.dataList=e.list}i.hide()})}},{key:"sendNotify",value:function(t){var e=this,a=this["$createToast"]({time:0,txt:"发送中..."});a.show(),this.$store.dispatch("sendNotifyByFleetInfo",{fleetId:this.fleetId,departureTime:t.departureTime}).then(function(t){a.hide(),e.$createDialog({type:"alert",title:"操作提示",content:"发送成功，请勿多次发送",icon:"cubeic-alert"}).show()})}},{key:"refresh",value:function(){this.getTaskInfo(this.fleetId,this.departureTimeList)}},{key:"addCar",value:function(t){this.$router.push({name:"fleetTaskCalList",query:t})}},{key:"addOprate",value:function(t){var e=this;this.$createDialog({type:"prompt",title:"添加座位",prompt:{value:"",placeholder:"输入座位数",type:"number",min:1,max:53},onConfirm:function(a,i){e.addSeat(i,t)}}).show()}},{key:"addSeat",value:function(t,e){var a=this,i=this["$createToast"]({time:0,txt:"添加中..."});i.show(),this.$store.dispatch("updateTaskInfo",{fleetId:this.fleetId,departureTime:e,setInfo:{$inc:{poll:Number(t)}}}).then(function(s){console.log(s),s.success?(a.updateDataListPoll(e,Number(t)),a.$createDialog({type:"alert",title:"操作提示",content:"添加成功！",icon:"cubeic-alert"}).show()):a.$createDialog({type:"alert",title:"操作提示",content:"添加失败！",icon:"cubeic-alert"}).show(),i.hide()})}},{key:"updateDataListPoll",value:function(t,e){var a=0,i=0;this.dataList.some(function(e,s){if(e.departureTime===t)return a=s,i=e.poll||0,!0}),this.$set(this.dataList[a],"poll",i+Number(e))}},{key:"getFormatTime",value:function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1,s=e.getDate(),n=e.getDay(),o=["日","一","二","三","四","五","六"],c=e.getHours(),r=c>=12?"下午":"上午",l=e.getMinutes(),u=(e.getSeconds(),"");return u+=a+"年 ",u+=(i<10?"0"+i:i)+"月"+(s<10?"0"+s:s)+"日",u+=" 周"+o[n],u+=r,u+=" "+(c<10?"0"+c:c)+":"+(l<10?"0"+l:l),u}},{key:"getTime",value:function(t){if(!this.showTimes)return"";var e="start"===this.currentTab?t:this.pointObj.start.length+t;if(!this.timeRows[e])return"";var a=this.timeRows[e][e+1];return a?"去下个点位  预估路程："+Math.floor(a.distance/1e3)+"公里  预估时间："+this.secondsToTime(a.duration):"此点为终点站~"}},{key:"addTask",value:function(){this.$router.push({name:"fleetTaskUpdate",query:{type:"add",data:{}}})}},{key:"secondsToTime",value:function(t){var e,a,i;e=Math.floor(t/3600),i=t%3600,a=Math.floor(i/60),i%=60;var s="";return e&&(s=s+e+"小时"),a&&(s=s+a+"分钟"),i&&(s=s+i+"秒"),s}},{key:"saveTask",value:function(){var t=this,e=this["$createToast"]({time:0,txt:"保存中..."});e.show(),this.$store.dispatch("updateFleetInfoById",{id:this.fleetId,key:"fleetTask",data:this.dataList}).then(function(a){a.success&&(console.log(a,"oooooooooo"),t.$createDialog({type:"alert",title:"提示",content:"保存成功！",icon:"cubeic-alert"}).show()),e.hide()})}},{key:"validate",value:function(){var t=this,e=!0,a="";return Object.keys(this.pointObj).forEach(function(i){0===t.pointObj[i].length?(e=!1,a="start"===i?"出发点位必填":"到达点位必填"):t.pointObj[i].forEach(function(t){t.point&&t.point.location||(e=!1,a=t.label+"未添加定位！")})}),e||this.$createDialog({type:"alert",title:"提示",content:a,icon:"cubeic-alert"}).show(),e}},{key:"addOrUpdatePoint",value:function(t){var e=this.pointObj[this.currentTab][t],a=e.point?"update":"add",i=this.currentTab;this.$router.push({name:"mapSelect",query:{backInfo:{updateIndex:t,updateType:i},location:"update"===a?e.point.location:[]}})}},{key:"deletePoint",value:function(t){var e=this,a="任务删除将不会恢复，请确认是否删除！",i=this.$createDialog({type:"confirm",title:"删除确认",content:a,confirmBtn:{text:"确认删除",active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:"取消",active:!1,disabled:!1,href:"javascript:;"},onConfirm:function(){e.dataList.splice(t,1)},onCancel:function(){}});i.show()}},{key:"updateDialotText",value:function(t,e){this.pointTextDialot(t,"update",e)}},{key:"pointTextDialot",value:function(t,e,a){this.$router.push({})}},{key:"navChange",value:function(t){console.log(t),this.currentTab=t}},{key:"showInfo",value:function(t){console.log("sssss",t),this.$router.push({name:"fleetOrderList",query:{fleetId:this.fleetId,departureTime:t.departureTime}})}},{key:"routeChange",value:function(t){var e=this.$store.state.backData;if("fleetTask"===e.route){var a=e.data;"add"===a.type&&(console.log(a.data),this.dataList.push(a.data)),this.$store.commit("SET_BACK_DATA",{})}this.getTaskInfo(this.fleetId,this.departureTimeList)}},{key:"showTimes",get:function(){return this.timeRows&&this.timeRows.length>0}}]),e}(d["c"]);Object(u["a"])([Object(d["b"])({default:"default value"})],p.prototype,"propB",void 0),Object(u["a"])([Object(d["d"])("$route")],p.prototype,"routeChange",null),p=Object(u["a"])([Object(d["a"])({components:{Page:v["a"],pageView:h["a"],navView:f["a"]}})],p);var b=p,m=b,y=(a("7a75"),a("2877")),k=Object(y["a"])(m,i,s,!1,null,null,null);e["default"]=k.exports},"2b1f":function(t,e,a){},"3a45":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"page-move"}},[a("router-view",{staticClass:"cube-view"})],1)},s=[],n={},o=n,c=(a("72ee"),a("2877")),r=Object(c["a"])(o,i,s,!1,null,null,null);e["a"]=r.exports},"72ee":function(t,e,a){"use strict";var i=a("2b1f"),s=a.n(i);s.a},"7a75":function(t,e,a){"use strict";var i=a("9931"),s=a.n(i);s.a},9931:function(t,e,a){},b13e:function(t,e,a){},ca73:function(t,e,a){"use strict";var i=a("b13e"),s=a.n(i);s.a}}]);
//# sourceMappingURL=fleetTaskInfo.f10083fa.js.map