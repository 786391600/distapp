(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shopAdmin"],{"07e8":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cube-page",class:e.type},[i("header",{staticClass:"header"},[i("h1",[e._v(e._s(e.title))]),i("i",{directives:[{name:"show",rawName:"v-show",value:e.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:e.back}}),i("div",{staticClass:"header-edit"},[e._t("edit")],2)]),i("div",{class:{wrapper:!0,isWhite:"white"===e.type}},[i("main",{staticClass:"content"},[e._t("content",[e._v(e._s(e.content))])],2)])])},n=[],s=i("d225"),c=i("b0b4"),o=i("308d"),r=i("6bb5"),l=i("4e2b"),u=i("9ab4"),d=i("60a3"),b=function(e){function t(){return Object(s["a"])(this,t),Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"back",value:function(){this.$router.go(-1)}},{key:"created",value:function(){console.log("创建page ===")}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])()],b.prototype,"msg",void 0),Object(u["a"])([Object(d["b"])({default:"",required:!0})],b.prototype,"title",void 0),Object(u["a"])([Object(d["b"])({default:""})],b.prototype,"type",void 0),Object(u["a"])([Object(d["b"])({default:""})],b.prototype,"desc",void 0),Object(u["a"])([Object(d["b"])({default:""})],b.prototype,"content",void 0),Object(u["a"])([Object(d["b"])({default:!0})],b.prototype,"isBack",void 0),b=Object(u["a"])([Object(d["a"])({})],b);var f=b,m=f,p=(i("beaf"),i("2877")),v=Object(p["a"])(m,a,n,!1,null,"40de0fef",null);t["a"]=v.exports},"084f":function(e,t,i){"use strict";var a=i("2095"),n=i.n(a);n.a},"170d":function(e,t,i){},"1b91":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page",{attrs:{title:e.pageTitle}},[i("div",{staticClass:"edit",attrs:{slot:"edit"},slot:"edit"},[i("div",{staticClass:"btn",on:{click:e.saveFood}},[e._v("保存店铺")])]),i("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"shop-admin-box"},[i("div",{staticClass:"left-nav"},[e._l(e.data,function(t,a){return i("div",{key:t.id,class:{"nav-item":!0,active:a===e.currentIndex},on:{click:function(t){return e.navClick(a)}}},[e._v("\n          "+e._s(t.name)+"\n        ")])}),i("div",{staticClass:"nav-item add-item",on:{click:e.addNav}},[e._v("添加分类")])],2),i("div",{ref:"rightBox",staticClass:"right-box"},[e._l(this.data[e.currentIndex].menu,function(t,a){return i("div",{key:t.id,staticClass:"food-item"},[i("div",{staticClass:"food-img",style:{backgroundImage:"url("+(t.img?t.img:e.defaultImg)+")"},attrs:{src:t.img}}),i("div",{staticClass:"food-info"},[i("div",{staticClass:"name"},[e._v(e._s(t.name))]),i("div",{staticClass:"price"},[e._v("￥"+e._s(t.price))]),i("div",{staticClass:"oprate"},[i("div",{staticClass:"btn",on:{click:function(i){return e.editMenu(t,a)}}},[e._v("编辑")]),i("div",{staticClass:"btn delete",on:{click:function(i){return e.deleteMenu(t,a)}}},[e._v("删除")])])])])}),i("textButton",{attrs:{block:!0},on:{click:e.addFood}},[e._v("+添加商品")])],2)]),i("editBox",{ref:"addForm1",attrs:{visible:e.showEditbox},on:{"update:visible":function(t){e.showEditbox=t}}},[i("editForm",{ref:"editForm",on:{cancel:function(t){e.showEditbox=!1},change:e.changeSuccess}})],1),i("editBox",{ref:"addForm1",attrs:{visible:e.showAddNav},on:{"update:visible":function(t){e.showAddNav=t}}},[i("addNav",{ref:"addNav",on:{cancel:function(t){e.showAddNav=!1},change:e.navChangeSuccess}})],1)],1)])},n=[],s=i("d225"),c=i("b0b4"),o=i("308d"),r=i("6bb5"),l=i("4e2b"),u=i("9ab4"),d=i("60a3"),b=i("07e8"),f=i("51f3"),m=i("35c0"),p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cube-form",{ref:"editForm",attrs:{model:e.model,"immediate-validate":!1,options:e.options},on:{validate:e.validateHandler,submit:e.submitHandler,reset:e.resetHandler}},[i("cube-form-group",{attrs:{legend:"商品编辑"}},[i("cube-form-item",{attrs:{field:e.fields[0]}}),i("cube-form-item",{attrs:{field:e.fields[1]}}),i("imageUpload",{model:{value:e.imageList,callback:function(t){e.imageList=t},expression:"imageList"}})],1),i("cube-form-group",{attrs:{legend:"商品规格"}},[e._l(e.model.menu,function(t,a){return i("div",{key:t.id,staticClass:"food-spec"},[i("div",{staticClass:"food-spec-item"},[i("div",[i("span",[e._v("名称")]),i("cube-input",{model:{value:t.spec,callback:function(i){e.$set(t,"spec",i)},expression:"menuItem.spec"}})],1),i("div",[i("span",[e._v("价格")]),i("cube-input",{model:{value:t.price,callback:function(i){e.$set(t,"price",i)},expression:"menuItem.price"}}),e._v("元\n        ")],1)]),i("div",{staticClass:"btn",on:{click:function(t){return e.deleteSpec(a)}}},[e._v("删除")])])}),i("text-button",{attrs:{block:!0},on:{click:e.addSpec}},[e._v("+添加规格")])],2),i("cube-form-group",[i("div",{staticClass:"submit-group"},[i("div",{staticClass:"btn reset",attrs:{inline:!0,outline:!0,type:"reset"},on:{click:e.resetClick}},[e._v("取消")]),i("div",{staticClass:"btn submit",attrs:{inline:!0,type:"submit"},on:{click:e.submitClick}},[e._v("保存")])])])],1)},v=[],h=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),O=(i("c5f6"),i("c88e")),g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"file-upload"},[e._l(e.imageArr,function(t,a){return i("div",{key:t,staticClass:"img-box"},[i("img",{staticClass:"preview-img",attrs:{src:t}}),i("i",{staticClass:"cubeic-wrong",on:{click:function(t){return e.deleteImg(a)}}})])}),i("cube-upload",{directives:[{name:"show",rawName:"v-show",value:e.imageArr.length<e.imgNum,expression:"imageArr.length < imgNum"}],ref:"upload",attrs:{max:1,action:e.action,"simultaneous-uploads":1},on:{"files-added":e.filesAdded,"file-removed":e.fileRemove,"file-success":e.fileSuccess}})],2)},j=[],y=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments)),e.fileUrl="http://img.beijixiong.club:4869/",e.imageArr=[],e.action={target:"/fileUpload",data:{token:"rwwXO0wQq5SBEqP7"}},e.isUploading=!0,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"upload",value:function(){this.isUploading=!0,this.$refs.upload.start()}},{key:"pause",value:function(){this.isUploading=!1,this.$refs.upload.pause()}},{key:"retry",value:function(){this.$refs.upload.retry()}},{key:"filesAdded",value:function(e){var t=!1,i=1048576;for(var a in e){var n=e[a];n.size>i&&(n.ignore=!0,t=!0)}t&&this.$createToast({type:"warn",time:2e3,txt:"文件需要小于1M"}).show()}},{key:"fileRemove",value:function(e){if(e.response&&e.response.md5){var t=this.fileUrl+e.response.md5,i=this.imageArr.indexOf(t);i>-1&&this.imageArr.splice(i,1)}}},{key:"fileSuccess",value:function(e){var t=e.response.url,i=this.imageArr.indexOf(t);-1===i&&this.imageArr.push(t),this.$refs.upload.removeFile(e),this.$emit("input",this.imageArr)}},{key:"mounted",value:function(){this.imageArr=Object(O["a"])(this.value)}},{key:"valueChange",value:function(e){e&&e.length>0&&(this.imageArr=Object(O["a"])(e))}},{key:"deleteImg",value:function(e){this.imageArr.splice(e,1),this.$emit("input",this.imageArr)}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])({default:[]})],y.prototype,"value",void 0),Object(u["a"])([Object(d["b"])({default:1})],y.prototype,"imgNum",void 0),Object(u["a"])([Object(d["d"])("value",{immediate:!0})],y.prototype,"valueChange",null),y=Object(u["a"])([Object(d["a"])({components:{},filters:{}})],y);var k=y,C=k,x=(i("343a"),i("2877")),_=Object(x["a"])(C,g,j,!1,null,"47569d6a",null),$=_.exports,w=i("7043");function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function A(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(i,!0).forEach(function(t){Object(h["a"])(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var N=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments)),e.validity={},e.valid=void 0,e.model={name:"",price:0},e.imageList=[],e.isEdit=!1,e.fields=[{type:"input",modelKey:"name",label:"商品名称",props:{placeholder:"请输入"},rules:{required:!0},trigger:"blur",messages:{required:"商品名称必填"}},{type:"input",modelKey:"price",label:"价格",props:{placeholder:"请输入"},rules:{required:!0,custom:function(e){return e>0}},messages:{required:"价格必填",custom:"价格需要大于等于0元"},trigger:"blur"}],e.options={scrollToInvalidField:!0,layout:"classic"},e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"resetHandler",value:function(){this.$emit("cancel")}},{key:"submitHandler",value:function(e){e.preventDefault();var t=Object(O["a"])(this.model.menu)||[],i=this.model.id,a=t.filter(function(e){return e.spec}).map(function(e,t){return e.id=i+"-"+t,e});(!a||a.length<=0)&&(a=null),this.model.menu=a,this.model.price=Number(this.model.price),this.imageList.length>0?this.model.img=this.imageList[0]:this.model.img="http://mmbiz.qpic.cn/mmbiz_png/5XHic5LQPCDjZwNLhL8Opj5Mkpib5mZgFLSmZDOO7dQP3yezUpIMIucia9yLL0M2Cft1Z1nicCErZByDN7teCYefiaA/0",this.$emit("change",this.model)}},{key:"setData",value:function(e){e.img&&this.$set(this,"imageList",[e.img]);var t=A({name:"",price:0,num:0,img:""},e);console.log(t,"ooooooooooooooooooo"),this.$set(this,"model",t)}},{key:"addSpec",value:function(){var e=this.model.menu&&this.model.menu.length>0?Object(O["a"])(this.model.menu):[],t=e&&e.length?e.length:0,i={id:this.model.id+""+t,num:0,price:0,spec:""};e.push(i),this.$set(this.model,"menu",e)}},{key:"deleteSpec",value:function(e){console.log(e,"");var t=Object(O["a"])(this.model.menu);t.splice(e,1),this.$set(this.model,"menu",t)}},{key:"submitClick",value:function(){this.$refs.editForm.submit(!1)}},{key:"resetClick",value:function(){this.$refs.editForm.reset()}},{key:"schoolInfo",get:function(){return this.$store.state.schoolInfo}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])({default:""})],N.prototype,"shopId",void 0),Object(u["a"])([Object(d["b"])({default:""})],N.prototype,"shopName",void 0),N=Object(u["a"])([Object(d["a"])({name:"addForm",components:{imageUpload:$,textButton:w["a"]}})],N);var D=N,E=D,F=(i("fe86"),i("7758"),Object(x["a"])(E,p,v,!1,null,"aae06cc4",null)),L=F.exports,S=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cube-form",{attrs:{model:e.model,"immediate-validate":!1,options:e.options},on:{validate:e.validateHandler,submit:e.submitHandler,reset:e.resetHandler}},[i("cube-form-group",{attrs:{legend:"分类编辑"}},[i("cube-form-item",{attrs:{field:e.fields[0]}})],1),i("cube-form-group",[i("cube-button",{attrs:{type:"submit"}},[e._v("保存")]),i("cube-button",{attrs:{type:"reset"}},[e._v("取消")])],1)],1)},B=[],M=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments)),e.validity={},e.valid=void 0,e.model={id:"",name:"",menu:[]},e.isEdit=!1,e.fields=[{type:"input",modelKey:"name",label:"分类名称",props:{placeholder:"请输入"},rules:{required:!0},trigger:"blur",messages:{required:"分类名称必填"}}],e.options={scrollToInvalidField:!0,layout:"classic"},e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"resetHandler",value:function(){this.$emit("cancel")}},{key:"submitHandler",value:function(e){e.preventDefault(),this.$emit("change",this.model)}},{key:"setData",value:function(e){this.$set(this,"model",e)}},{key:"deleteSpec",value:function(e){console.log(e,"");var t=Object(O["a"])(this.model.menu);t.splice(e,1),this.$set(this.model,"menu",t)}},{key:"schoolInfo",get:function(){return this.$store.state.schoolInfo}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])({default:""})],M.prototype,"shopId",void 0),Object(u["a"])([Object(d["b"])({default:""})],M.prototype,"shopName",void 0),M=Object(u["a"])([Object(d["a"])({name:"addForm"})],M);var P=M,q=P,H=(i("88fc"),Object(x["a"])(q,S,B,!1,null,"1d25b946",null)),U=H.exports,Z=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments)),e.showEditbox=!1,e.showAddNav=!1,e.pageTitle="商品管理",e.defaultImg="http://mmbiz.qpic.cn/mmbiz_png/5XHic5LQPCDjZwNLhL8Opj5Mkpib5mZgFLSmZDOO7dQP3yezUpIMIucia9yLL0M2Cft1Z1nicCErZByDN7teCYefiaA/0",e.data=[],e.currentIndex=0,e.modelIndex=0,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){var e=Object(O["a"])(this.$route.params.shopData);this.$set(this,"data",e)}},{key:"navClick",value:function(e){this.currentIndex=e,this.$refs.rightBox.scrollTop=0}},{key:"editMenu",value:function(e,t){var i=this;this.modelIndex=t;var a=Object(O["a"])(e);this.showEditbox=!0,this.$nextTick(function(){i.$refs.editForm.setData(a)})}},{key:"deleteMenu",value:function(e,t){var i=this;this.$createDialog({type:"confirm",content:"确定删除【"+e.name+"】吗？",onConfirm:function(e){var a=Object(O["a"])(i.data[i.currentIndex].menu);a.splice(t,1),i.$set(i.data[i.currentIndex],"menu",a)}}).show()}},{key:"changeSuccess",value:function(e){this.$set(this.data[this.currentIndex].menu,this.modelIndex,e),this.showEditbox=!1}},{key:"navChangeSuccess",value:function(e){var t=Object(O["a"])(e);if(!t.id){var i={id:"C"+(this.data.length?this.data.length:0),name:t.name,menu:[]};this.data.push(i)}this.showAddNav=!1}},{key:"addNav",value:function(){this.showAddNav=!0}},{key:"addFood",value:function(){var e=this.data[this.currentIndex].menu||[],t=this.data[this.currentIndex].id+"-"+e.length;this.editMenu({id:t,name:"",price:0,num:0},e.length)}},{key:"saveFood",value:function(){var e=this;this.$store.dispatch("updateShopInfo",{shopId:this.shopId,type:"shopData",value:this.data}).then(function(t){t.success&&e.$createDialog({type:"alert",content:"保存成功",onConfirm:function(t){e.$router.push({name:"businessManagement",params:{id:e.shopId,oprate:"update",type:"shopData",data:e.data}})}}).show()})}},{key:"shopId",get:function(){return this.$route.params.id}},{key:"shopName",get:function(){return this.$route.query.shopName}}]),t}(d["c"]);Z=Object(u["a"])([Object(d["a"])({components:{page:b["a"],rightBox:f["a"],editBox:m["a"],editForm:L,addNav:U,textButton:w["a"]}})],Z);var z=Z,T=z,Q=(i("084f"),Object(x["a"])(T,a,n,!1,null,null,null));t["default"]=Q.exports},2095:function(e,t,i){},"343a":function(e,t,i){"use strict";var a=i("d376"),n=i.n(a);n.a},"35c0":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"fade"}},[e.visible?i("div",{staticClass:"edit-box"},[e._t("default")],2):e._e()])},n=[],s=i("d225"),c=i("b0b4"),o=i("308d"),r=i("6bb5"),l=i("4e2b"),u=i("9ab4"),d=i("60a3"),b=function(e){function t(){return Object(s["a"])(this,t),Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){}},{key:"hide",value:function(){this.$emit("update:visible",!1)}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])({default:!1})],b.prototype,"visible",void 0),b=Object(u["a"])([Object(d["a"])({components:{}})],b);var f=b,m=f,p=(i("fa15"),i("2877")),v=Object(p["a"])(m,a,n,!1,null,"d5ca93a2",null);t["a"]=v.exports},"51f3":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"right-box"},e._l(e.list,function(t,a){return i("div",{key:a,staticClass:"box",on:{click:function(i){return e.boxClick(t.action)}}},[t.icon?i("i",{class:["iconfont",t.icon]}):i("span",[e._v(e._s(t.text))])])}),0)},n=[],s=i("d225"),c=i("b0b4"),o=i("308d"),r=i("6bb5"),l=i("4e2b"),u=i("9ab4"),d=i("60a3"),b=function(e){function t(){return Object(s["a"])(this,t),Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"boxClick",value:function(e){this.$emit("click",e)}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])()],b.prototype,"list",void 0),b=Object(u["a"])([d["a"]],b);var f=b,m=f,p=(i("b493"),i("2877")),v=Object(p["a"])(m,a,n,!1,null,"1bd23a4e",null);t["a"]=v.exports},7043:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{class:{block:e.block,"text-btn":!0},on:{click:e.onClick}},[e._t("default")],2)},n=[],s=i("d225"),c=i("b0b4"),o=i("308d"),r=i("6bb5"),l=i("4e2b"),u=i("9ab4"),d=i("60a3"),b=function(e){function t(){return Object(s["a"])(this,t),Object(o["a"])(this,Object(r["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"onClick",value:function(){this.$emit("click")}}]),t}(d["c"]);Object(u["a"])([Object(d["b"])({default:!1})],b.prototype,"block",void 0),b=Object(u["a"])([Object(d["a"])({})],b);var f=b,m=f,p=(i("ad5e"),i("2877")),v=Object(p["a"])(m,a,n,!1,null,"6e5ba166",null);t["a"]=v.exports},7758:function(e,t,i){"use strict";var a=i("170d"),n=i.n(a);n.a},"88fc":function(e,t,i){"use strict";var a=i("b409"),n=i.n(a);n.a},a387:function(e,t,i){},ad5e:function(e,t,i){"use strict";var a=i("e029"),n=i.n(a);n.a},b409:function(e,t,i){},b491:function(e,t,i){},b493:function(e,t,i){"use strict";var a=i("a387"),n=i.n(a);n.a},beaf:function(e,t,i){"use strict";var a=i("b491"),n=i.n(a);n.a},c88e:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var a=i("7618");i("3b2b"),i("a481");var n=function e(t){var i;if("object"===Object(a["a"])(t))if(null===t)i=null;else if(t instanceof Date)i=t;else if(t instanceof Array){i=[];for(var n=0,s=t.length;n<s;n++)i.push(e(t[n]))}else for(var c in i={},t)i[c]=e(t[c]);else i=t;return i}},d376:function(e,t,i){},e029:function(e,t,i){},e835:function(e,t,i){},e96c:function(e,t,i){},fa15:function(e,t,i){"use strict";var a=i("e835"),n=i.n(a);n.a},fe86:function(e,t,i){"use strict";var a=i("e96c"),n=i.n(a);n.a}}]);
//# sourceMappingURL=shopAdmin.996fc71e.js.map