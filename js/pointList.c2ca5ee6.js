(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pointList"],{"07e8":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cube-page",class:t.type},[i("header",{staticClass:"header"},[i("h1",[t._v(t._s(t.title))]),i("i",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],staticClass:"cubeic-back",on:{click:t.back}}),i("div",{staticClass:"header-edit"},[t._t("edit")],2)]),i("div",{class:{wrapper:!0,isWhite:"white"===t.type}},[i("section",{directives:[{name:"show",rawName:"v-show",value:t.desc,expression:"desc"}],staticClass:"desc"},[t._t("desc",[t._v(t._s(t.desc))])],2),i("main",{staticClass:"content"},[t._t("content",[t._v(t._s(t.content))])],2)])])},n=[],s=i("d225"),o=i("b0b4"),c=i("308d"),l=i("6bb5"),r=i("4e2b"),u=i("9ab4"),v=i("60a3"),b=function(t){function e(){return Object(s["a"])(this,e),Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments))}return Object(r["a"])(e,t),Object(o["a"])(e,[{key:"back",value:function(){this.$router.back()}}]),e}(v["c"]);Object(u["a"])([Object(v["b"])()],b.prototype,"msg",void 0),Object(u["a"])([Object(v["b"])({default:"",required:!0})],b.prototype,"title",void 0),Object(u["a"])([Object(v["b"])({default:""})],b.prototype,"type",void 0),Object(u["a"])([Object(v["b"])({default:""})],b.prototype,"desc",void 0),Object(u["a"])([Object(v["b"])({default:""})],b.prototype,"content",void 0),Object(u["a"])([Object(v["b"])({default:!0})],b.prototype,"isBack",void 0),b=Object(u["a"])([v["a"]],b);var d=b,p=d,h=(i("ca73"),i("2877")),f=Object(h["a"])(p,a,n,!1,null,"0717ebb4",null);e["a"]=f.exports},"0c27":function(t,e,i){},"103f":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page",{attrs:{type:"form-def",title:t.title,isBack:!0}},[i("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[i("navView",{attrs:{list:t.navList},on:{change:t.navChange}}),t.showTimes?i("div",{staticClass:"oprate top-line"},[i("div",{staticClass:"btn"},[t._v("\r\n            "+t._s(t.showTimes?"点位时间已更新":"点位时间更新中...")+"\r\n        ")])]):t._e(),i("div",{staticClass:"list"},[t._l(t.pointObj[t.currentTab],function(e,a){return i("div",{key:a,staticClass:"list-item"},[i("div",{staticClass:"list-item-title"},[t._v(t._s(a+1)+"."+t._s(e.label))]),i("div",{staticClass:"list-item-content"},[t._v(t._s(e.point?e.point.label:"未添加定位"))]),t.showTimes?i("div",{staticClass:"list-item-content"},[t._v(t._s(t.getTime(a)))]):t._e(),i("div",{staticClass:"oprate"},[i("div",{staticClass:"btn",on:{click:function(i){return t.updateDialotText(e.label,a)}}},[t._v("\r\n                 修改名称\r\n              ")]),i("div",{staticClass:"btn",on:{click:function(i){return t.addOrUpdatePoint(a,e)}}},[t._v("\r\n                 "+t._s(e.point?"修改定位":"添加定位")+"\r\n              ")]),i("div",{staticClass:"btn",on:{click:function(e){return t.deletePoint(a)}}},[t._v("\r\n                 删除\r\n              ")])])])}),i("div",{staticClass:"oprate top-line"},[i("div",{staticClass:"btn",on:{click:t.addPoint}},[t._v("\r\n                 +添加点位\r\n            ")]),i("div",{staticClass:"btn success",on:{click:t.savePoint}},[t._v("\r\n                 保存\r\n            ")])])],2),i("pageView")],1)])},n=[],s=(i("456d"),i("ac6a"),i("d225")),o=i("b0b4"),c=i("308d"),l=i("6bb5"),r=i("4e2b"),u=i("9ab4"),v=i("60a3"),b=i("07e8"),d=i("3a45"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav-box"},[i("div",{staticClass:"nav-scroll"},[i("div",{staticClass:"item-box"},t._l(t.list,function(e,a){return i("div",{key:a,class:{box:!0,active:t.currentValue===e.value},on:{click:function(i){return t.setValue(e.value)}}},[t._v(t._s(e.label))])}),0)])])},h=[],f=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.currentValue="",t}return Object(r["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){console.log("navvvvvvvvvvvvvvvvvvvvvvvvvvvvv"),this.currentValue=this.list[0].value,this.emitValue(this.list[0].value)}},{key:"setValue",value:function(t){this.currentValue=t,this.emitValue(t)}},{key:"emitValue",value:function(t){this.$emit("change",t)}}]),e}(v["c"]);Object(u["a"])([Object(v["b"])()],f.prototype,"list",void 0),f=Object(u["a"])([Object(v["a"])({components:{}})],f);var O=f,j=O,y=(i("1266"),i("2877")),m=Object(y["a"])(j,p,h,!1,null,null,null),k=m.exports,w=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.point={},t.showMore=!0,t.currentTab="",t.navList=[{label:"出发点位",value:"start"},{label:"到达点位",value:"end"}],t.pointObj={start:[],end:[]},t.timeRows=[],t.dialog=null,t}return Object(r["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){this.pointList=[],this.fleetId=this.$route.query.fleetId,this.title="点位列表",this.getFleetInfoById(this.fleetId)}},{key:"getFleetInfoById",value:function(t){var e=this,i=this["$createToast"]({time:0,txt:"加载..."});i.show(),this.$store.dispatch("getFleetInfoById",{id:t}).then(function(t){if(t.success){console.log(t,"oooooooooo");var a=t.data,n=a.point||{start:[],end:[]};e.pointObj=n,e.$set(e,"timeRows",a.timeRows)}i.hide()})}},{key:"getTime",value:function(t){if(!this.showTimes)return"";var e="start"===this.currentTab?t:this.pointObj.start.length+t;if(!this.timeRows[e])return"";var i=this.timeRows[e][e+1];return i?"去下个点位  预估路程："+Math.floor(i.distance/1e3)+"公里  预估时间："+this.secondsToTime(i.duration):"此点为终点站~"}},{key:"addPoint",value:function(){this.pointTextDialot("")}},{key:"secondsToTime",value:function(t){var e,i,a;e=Math.floor(t/3600),a=t%3600,i=Math.floor(a/60),a%=60;var n="";return e&&(n=n+e+"小时"),i&&(n=n+i+"分钟"),a&&(n=n+a+"秒"),n}},{key:"savePoint",value:function(){var t=this;console.log(this.pointObj);var e=this.validate();if(e){var i=this["$createToast"]({time:0,txt:"保存中..."});i.show(),this.$store.dispatch("updateFleetInfoById",{id:this.fleetId,key:"point",data:this.pointObj}).then(function(e){e.success&&(console.log(e,"oooooooooo"),t.$set(t,"timeRows",[]),t.$createDialog({type:"alert",title:"提示",content:"保存成功！",icon:"cubeic-alert"}).show()),i.hide()})}}},{key:"validate",value:function(){var t=this,e=!0,i="";return Object.keys(this.pointObj).forEach(function(a){0===t.pointObj[a].length?(e=!1,i="start"===a?"出发点位必填":"到达点位必填"):t.pointObj[a].forEach(function(t){t.point&&t.point.location||(e=!1,i=t.label+"未添加定位！")})}),e||this.$createDialog({type:"alert",title:"提示",content:i,icon:"cubeic-alert"}).show(),e}},{key:"addOrUpdatePoint",value:function(t){var e=this.pointObj[this.currentTab][t],i=e.point?"update":"add",a=this.currentTab;this.$router.push({name:"mapSelect",query:{backInfo:{updateIndex:t,updateType:a},location:"update"===i?e.point.location:[]}})}},{key:"deletePoint",value:function(t){this.pointObj[this.currentTab].splice(t,1)}},{key:"updateDialotText",value:function(t,e){this.pointTextDialot(t,"update",e)}},{key:"pointTextDialot",value:function(t,e,i){var a=this,n=t||"";this.dialog=this.$createDialog({type:"prompt",title:t?"修改点位":"添加点位",prompt:{value:n,placeholder:"请输入"},onConfirm:function(t,n){if(n)if(e){var s=a.pointObj[a.currentTab][i];s.label=n,a.pointObj[a.currentTab],a.$set(a.pointObj[a.currentTab],i,s)}else a.pointObj[a.currentTab].push({label:n})}}).show()}},{key:"navChange",value:function(t){console.log(t),this.currentTab=t}},{key:"routeChange",value:function(t){var e=this.$store.state.backData;if(console.log(e,"ssssssss"),"point"===e.route){var i=e.data,a=i.backInfo;this.$set(this.pointObj[a.updateType][a.updateIndex],"point",{label:i.label||"未设置定位",location:i.coordinate})}}},{key:"showTimes",get:function(){return this.timeRows&&this.timeRows.length>0}}]),e}(v["c"]);Object(u["a"])([Object(v["b"])({default:"default value"})],w.prototype,"propB",void 0),Object(u["a"])([Object(v["d"])("$route")],w.prototype,"routeChange",null),w=Object(u["a"])([Object(v["a"])({components:{Page:b["a"],pageView:d["a"],navView:k}})],w);var _=w,g=_,T=(i("d083"),Object(y["a"])(g,a,n,!1,null,null,null));e["default"]=T.exports},1266:function(t,e,i){"use strict";var a=i("0c27"),n=i.n(a);n.a},2609:function(t,e,i){},"2b1f":function(t,e,i){},"3a45":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"page-move"}},[i("router-view",{staticClass:"cube-view"})],1)},n=[],s={},o=s,c=(i("72ee"),i("2877")),l=Object(c["a"])(o,a,n,!1,null,null,null);e["a"]=l.exports},"72ee":function(t,e,i){"use strict";var a=i("2b1f"),n=i.n(a);n.a},b13e:function(t,e,i){},ca73:function(t,e,i){"use strict";var a=i("b13e"),n=i.n(a);n.a},d083:function(t,e,i){"use strict";var a=i("2609"),n=i.n(a);n.a}}]);
//# sourceMappingURL=pointList.c2ca5ee6.js.map